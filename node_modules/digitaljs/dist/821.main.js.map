{"version":3,"file":"821.main.js","mappings":"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","sources":["webpack://digitaljs/webpack/universalModuleDefinition","webpack://digitaljs/webpack/runtime/chunk loaded","webpack://digitaljs/webpack/runtime/startup chunk dependencies","webpack://digitaljs/./src/tools.mjs","webpack://digitaljs/./src/cells/base.mjs","webpack://digitaljs/./src/cells/io.mjs","webpack://digitaljs/./src/cells/gates.mjs","webpack://digitaljs/./src/cells/arith.mjs","webpack://digitaljs/./src/cells/bus.mjs","webpack://digitaljs/./src/cells/subcircuit.mjs","webpack://digitaljs/./src/cells/mux.mjs","webpack://digitaljs/./src/cells/dff.mjs","webpack://digitaljs/./src/help.mjs","webpack://digitaljs/./src/cells/memory.mjs","webpack://digitaljs/./src/cells/fsm.mjs","webpack://digitaljs/./src/cells/display7.mjs","webpack://digitaljs/./src/engines/worker-worker.mjs","webpack://digitaljs/webpack/bootstrap","webpack://digitaljs/webpack/runtime/define property getters","webpack://digitaljs/webpack/runtime/ensure chunk","webpack://digitaljs/webpack/runtime/get javascript chunk filename","webpack://digitaljs/webpack/runtime/global","webpack://digitaljs/webpack/runtime/hasOwnProperty shorthand","webpack://digitaljs/webpack/runtime/make namespace object","webpack://digitaljs/webpack/runtime/node module decorator","webpack://digitaljs/webpack/runtime/publicPath","webpack://digitaljs/webpack/runtime/importScripts chunk loading","webpack://digitaljs/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"digitaljs\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"digitaljs\"] = factory();\n\telse\n\t\troot[\"digitaljs\"] = factory();\n})(this, () => {\nreturn ","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn __webpack_require__.e(268).then(next);\n};","\"use strict\";\n\nimport * as joint from '@joint/core';\nimport _ from 'lodash';\n\nconst circleArrowhead = {\n    tagName: 'circle',\n    attributes: {\n        'r': 7,\n        'fill': 'black',\n        'fill-opacity': 0.3,\n        'stroke': 'black',\n        'stroke-width': 2,\n        'cursor': 'move'\n    }\n};\nexport const CircleSourceArrowhead = joint.linkTools.SourceArrowhead.extend(_.merge({}, circleArrowhead));\nexport const CircleTargetArrowhead = joint.linkTools.TargetArrowhead.extend(_.merge({}, circleArrowhead));\n\nexport const DoublyButton = joint.linkTools.Button.extend({\n    update() {\n        if (this.relatedView.isShortWire()) {\n            this.options.distance = this.options.distanceShort || this.options.distance;\n            if (this.options.secondary) this.hide();\n        } else {\n            this.options.distance = this.options.distanceLong || this.options.distance;\n        }\n        return joint.linkTools.Button.prototype.update.apply(this, arguments);\n    }\n});\nexport const RemoveButton = DoublyButton.extend({\n    name: 'remove',\n    children: joint.linkTools.Remove.prototype.children,\n    options: joint.linkTools.Remove.prototype.options\n});\nexport const MonitorButton = DoublyButton.extend({\n    name: 'monitor',\n    children: [{\n        tagName: 'circle',\n        selector: 'button',\n        attributes: {\n            'r': 7,\n            'fill': '#001DFF',\n            'cursor': 'pointer'\n        }\n    }, {\n        tagName: 'path',\n        selector: 'icon',\n        attributes: {\n            'd': 'm -2.5,-0.5 a 2,2 0 1 0 4,0 2,2 0 1 0 -4,0 M 1,1 3,3',\n            'fill': 'none',\n            'stroke': '#FFFFFF',\n            'stroke-width': 2,\n            'pointer-events': 'none'\n        }\n    }],\n    options: {\n        action(evt) {\n            this.notify('link:monitor');\n        }\n    }\n});\n","\"use strict\";\n\nimport * as joint from '@joint/core';\nimport _ from 'lodash';\nimport { Vector3vl } from '3vl';\nimport * as tools from '../tools.mjs';\nimport $ from 'jquery';\n\nexport const portGroupAttrs = {\n    wire: {\n        stroke: '#4B4F6A',\n        x1: 0, y1: 0,\n        x2: undefined, y2: 0\n    },\n    port: {\n        magnet: undefined,\n        r: 7,\n        stroke: 'black',\n        fill: 'white',\n        strokeWidth: 2,\n        strokeOpacity: 0.5\n    },\n    bits: {\n        ref: 'port',\n        fill: 'black',\n        fontSize: '7pt'\n    },\n    iolabel: {\n        textVerticalAnchor: 'middle',\n        fill: 'black',\n        fontSize: '8pt'\n    },\n    decor: {\n        stroke: 'black',\n        fill: 'transparent'\n    }\n};\n\n// Common base class for gate models\nexport const Gate = joint.dia.Element.define('Gate', {\n    /* default properties */\n    propagation: 1,\n    label: '',\n\n    size: { width: 80, height: 30 },\n    inputSignals: {},\n    outputSignals: {},\n    attrs: {\n        '.': { magnet: false },\n        body: { stroke: 'black', strokeWidth: 2 },\n        label: {\n            refX: .5, refDy: 3,\n            textAnchor: 'middle',\n            fontSize: '8pt',\n            fill: 'black'\n        }\n    },\n    ports: {\n        groups: {\n            'in': {\n                position: 'left',\n                attrs: _.merge({}, portGroupAttrs, {\n                    wire: { x2: -25 },\n                    port: { magnet: 'passive', refX: -25 },\n                    bits: { refDx: 1, refY: -3, textAnchor: 'start' },\n                    iolabel: { refX: 5, textAnchor: 'start' }\n                })\n            },\n            'out': {\n                position: 'right',\n                attrs: _.merge({}, portGroupAttrs, {\n                    wire: { x2: 25 },\n                    port: { magnet: true, refX: 25 },\n                    bits: { refX: -1, refY: -3, textAnchor: 'end' },\n                    iolabel: { refX: -5, textAnchor: 'end' }\n                })\n            }\n        }\n    },\n\n    z: 1\n}, {\n    operation() {\n        return {};\n    },\n    initialize() {\n        // pre-process ports\n        const ports = this.get('ports');\n        if (ports.items) {\n            this._preprocessPorts(ports.items);\n        }\n        joint.dia.Element.prototype.initialize.apply(this, arguments);\n        this.prepare();\n\n        this.bindAttrToProp('label/text', 'label');\n        if (this._unsupportedPropChanges.length > 0) {\n            this.on(this._unsupportedPropChanges.map(prop => 'change:'+prop).join(' '), (__, ___, opt) => {\n                if (opt.init) return;\n\n                const changed = _.intersection(Object.keys(this.changed), this._unsupportedPropChanges);\n                changed.forEach(attr => {\n                    this.set(attr, this.previous(attr), {init: true});\n                });\n                console.warn('Beta property change support: \"' + changed + '\" changes on ' + this.get('type') + ' are (currently) not supported.');\n            });\n        }\n    },\n    prepare() {\n    },\n    bindAttrToProp(attr, prop) {\n        this.attr(attr, this.get(prop));\n        this.on('change:' + prop, (_, val) => this.attr(attr, val));\n    },\n\n    /*\n     * Private methods.\n     */\n    _changeOutputSignals(sigs) {\n        _.chain(this.graph.getConnectedLinks(this, {outbound: true}))\n            .groupBy((wire) => wire.get('source').port)\n            .forEach((wires, port) => \n                wires.forEach((wire) => wire.set('signal', sigs[port])))\n            .value();\n    },\n    _setInput(sig, port) {\n        const signals = _.clone(this.get('inputSignals'));\n        signals[port] = sig;\n        this.set('inputSignals', signals);\n    },\n    _clearInput(port) {\n        const bits = this.getPort(port).bits;\n        this._setInput(Vector3vl.xes(bits), port);\n    },\n    _preprocessPorts(ports) {\n        this._resetPortsSignals(ports);\n        for (const port of ports) {\n            port.attrs = {};\n            port.attrs['bits'] = { text: this._getBitsText(port.bits) }\n            if (port.labelled) {\n                const iolabel = { text: 'portlabel' in port ? port.portlabel : port.id };\n                if (port.polarity === false)\n                    iolabel['text-decoration'] = 'overline';\n                if (port.decor) {\n                    console.assert(port.group == 'in');\n                    iolabel['refX'] = 10;\n                }\n                port.attrs['iolabel'] = iolabel;\n            }\n            if (port.decor) {\n                port.attrs['decor'] = { d: port.decor };\n            }\n        }\n    },\n    _setPortsBits(portsBits) {\n        const ports = _.cloneDeep(this.get('ports'));\n        const portsReset = [];\n        for (const portid in portsBits) {\n            const bits = portsBits[portid];\n            const port = ports.items.find(function(port) {\n                return port.id && port.id === portid;\n            });\n            port.bits = bits;\n            port.attrs['bits'].text = this._getBitsText(bits);\n            portsReset.push(port);\n        }\n        this._resetPortsSignals(portsReset);\n        //trigger port changes on model and view\n        this.set('ports', ports);\n        this.graph.getConnectedLinks(this, { outbound: true })\n            .filter((wire) => wire.get('source').port in portsBits)\n            .forEach((wire) => wire._changeSource(wire.get('source')));\n        this.graph.getConnectedLinks(this, { inbound: true })\n            .filter((wire) => wire.get('target').port in portsBits)\n            .forEach((wire) => wire._changeTarget(wire.get('target')));\n    },\n    _getBitsText(bits) {\n        return bits > 1 ? bits : '';\n    },\n    _resetPortValue(port) {\n        return Vector3vl.xes(port.bits);\n    },\n    _resetPortsSignals(ports) {\n        const signals = {\n            in: this.get('inputSignals'),\n            out: this.get('outputSignals')\n        }\n\n        for (const port of ports) {\n            console.assert(port.bits >= 0);\n            signals[port.dir][port.id] = this._resetPortValue(port);\n        }\n\n        this.set('inputSignals', signals.in);\n        this.set('outputSignals', signals.out);\n    },\n    _removePortsSignals(ports) {\n        const signals = {\n            in: this.get('inputSignals'),\n            out: this.get('outputSignals')\n        }\n\n        for (const port of ports) {\n            delete signals[port.dir][port.id];\n        }\n\n        this.set('inputSignals', signals.in);\n        this.set('outputSignals', signals.out);\n    },\n\n    /*\n     * JointJS port interface with custom hooks to adapt signals.\n     */\n    addPort(port) {\n        this.addPorts([port]);\n    },\n    addPorts(ports) {\n        this._preprocessPorts(ports);\n        joint.dia.Element.prototype.addPorts.apply(this, arguments);\n    },\n    removePort(port, opt) {\n        this.removePorts([port]);\n    },\n    removePorts(ports, opt) {\n        this._removePortsSignals(ports);\n        joint.dia.Element.prototype.removePorts.apply(this, arguments);\n    },\n\n    /*\n     * Layout methods.\n     */\n    _getStackedPosition(opt) {\n        return function(portsArgs, elBBox) {\n            // ports stacked from top to bottom or left to right\n            const side = opt.side || 'left';\n            const step = opt.step || 16;\n            const offset = opt.offset || 12;\n            const x = side == 'left' ? elBBox.topLeft().x : side == 'right' ? elBBox.topRight().x : undefined;\n            const y = side == 'top' ? elBBox.topLeft().y : side == 'bottom' ? elBBox.bottomRight().y : undefined;\n            if (x !== undefined) {\n                return _.map(portsArgs, function(portArgs, index) {\n                    index += portArgs.idxOffset || 0;\n                    return joint.g.Point({ x: x, y: index*step + offset });\n                });\n            } else {\n                return _.map(portsArgs, function(portArgs, index) {\n                    index += portArgs.idxOffset || 0;\n                    return joint.g.Point({ x: index*step + offset, y: y });\n                });\n            }\n        }\n    },\n    getLayoutSize() {\n        return this.size();\n    },\n    setLayoutPosition(position) {\n        this.set('position', {\n            x: position.x,\n            y: position.y\n        });\n    },\n\n    /*\n     * View Markup.\n     */\n    portMarkup: [{\n        tagName: 'line',\n        className: 'wire',\n        selector: 'wire'\n    }, {\n        tagName: 'circle',\n        className: 'port',\n        selector: 'port'\n    }, {\n        tagName: 'text',\n        className: 'bits',\n        selector: 'bits'\n    }, {\n        tagName: 'text',\n        className: 'iolabel',\n        selector: 'iolabel'\n    }, {\n        tagName: 'path',\n        className: 'decor',\n        selector: 'decor'\n    }],\n    //portLabelMarkup: null, //todo: see https://github.com/clientIO/joint/issues/1278\n    markup: [{\n        tagName: 'text',\n        className: 'label',\n        selector: 'label'\n    }],\n\n    /*\n     * Gate parameters for serialization.\n     */\n    getGateParams(layout) {\n        return _.cloneDeep(_.pick(this.attributes, this._gateParams.concat(layout ? this._gateLayoutParams : [])));\n    },\n    _gateParams: ['label', 'type', 'propagation', 'source_positions'],\n    _gateLayoutParams: ['position'],\n    _unsupportedPropChanges: [],\n    _operationHelpers: [],\n    _presentationParams: []\n});\n\nexport const GateView = joint.dia.ElementView.extend({\n    attrs: {\n        signal: {\n            high: { port: { 'stroke': '#03c03c' } },\n            low: { port: { 'stroke': '#fc7c68' } },\n            def: { port: { 'stroke': '#779ecb' } },\n            undef: { port: { 'stroke': '#999' } }\n        }\n    },\n    presentationAttributes: joint.dia.ElementView.addPresentationAttributes({\n        inputSignals: 'SIGNAL',\n        outputSignals: 'SIGNAL2'\n    }),\n    stopprop(evt) {\n        evt.stopPropagation();\n    },\n    confirmUpdate(flags) {\n        if (this.hasFlag(flags, 'SIGNAL')) {\n            this._updatePortSignals('in');\n        }\n        if (this.hasFlag(flags, 'SIGNAL2')) {\n            this._updatePortSignals('out');\n        }\n        joint.dia.ElementView.prototype.confirmUpdate.apply(this, arguments);\n    },\n    _updatePortSignals(dir) {\n        const signals =\n            dir === 'in' ? this.model.get('inputSignals') :\n            dir === 'out' ? this.model.get('outputSignals') :\n            _.merge({}, this.model.get('inputSignals'), this.model.get('outputSignals'));\n        for (const port in signals) {\n            const signal = signals[port];\n            const attrs = this.attrs.signal[\n                !signal.isDefined ? 'undef' :\n                signal.isHigh ? 'high' :\n                signal.isLow ? 'low' : 'def'\n            ];\n            this._applyPortAttrs(port, attrs);\n        }\n    },\n    _applyAttrs(attrs) {\n        for (const selector in attrs) {\n            const node = this.selectors[selector];\n            this.setNodeAttributes(node, attrs[selector]);\n        }\n    },\n    _applyPortAttrs(port, attrs) {\n        if (port in this._portElementsCache) {\n            for (const selector in attrs) {\n                const node = this._portElementsCache[port].portSelectors[selector];\n                this.setNodeAttributes(node, attrs[selector]);\n            }\n        }\n    },\n    // overrides joint.dia.ElementView.prototype._updatePorts to reflect port signals\n    _updatePorts() {\n        joint.dia.ElementView.prototype._updatePorts.apply(this, arguments);\n        this._updatePortSignals();\n    }\n});\n\n// Connecting wire model\nexport const Wire = joint.shapes.standard.Link.define('Wire', {\n    attrs: {\n        line: {\n            class: 'connection',\n            targetMarker: null\n        },\n        wrapper: {\n            stroke: 'red'\n        }\n    },\n\n    signal: Vector3vl.xes(1),\n    bits: 1,\n    warning: false,\n\n    // show behind gates\n    z: 0\n}, {\n    initialize() {\n        joint.shapes.standard.Link.prototype.initialize.apply(this, arguments);\n        if (this.has('netname')) {\n            this.label(0, {\n                markup: [\n                    {\n                        tagName: 'text',\n                        selector: 'label'\n                    }\n                ],\n                attrs: {\n                    label: {\n                        text: this.get('netname'),\n                        fill: 'black',\n                        fontSize: '8pt'\n                    }\n                },\n                position: {\n                    distance: 0.5\n                }\n            });\n        }\n    },\n    onAdd() {\n        this._changeSource(this.get('source'));\n        this._was_added = true; // hacky fix for warnings calculation\n    },\n    remove() {\n        const tar = this.get('target');\n        const target = this.graph.getCell(tar.id);\n        if (target && 'port' in tar) {\n            target._clearInput(tar.port);\n        }\n        joint.shapes.standard.Link.prototype.remove.apply(this, arguments);\n    },\n\n    /*\n     * Private methods.\n     */\n    _propagateSignal(tar, sig) {\n        const target = this.getTargetElement();\n        if (target) {\n            if (this.get('warning'))\n                target._clearInput(tar.port);\n            else\n                target._setInput(sig, tar.port);\n        }\n    },\n    _changeSignal(sig) {\n        this._propagateSignal(this.get('target'), sig);\n    },\n    _changeSource(src) {\n        const source = this.getSourceElement();\n        if (source && 'port' in src) {\n            this.set('bits', source.getPort(src.port).bits);\n            this._checkConnection();\n            //set signal after checking connection to avoid false signal propagation\n            this.set('signal', source.get('outputSignals')[src.port]);\n        } else {\n            this.set('signal', Vector3vl.xes(this.get('bits')));\n        }\n    },\n    _changeTarget(tar) {\n        this._checkConnection();\n        if ('port' in tar) {\n            this._propagateSignal(tar, this.get('signal'));\n        }\n        if (!this.hasChanged('target')) return;\n        const preTar = this.previous('target');\n        const preTarget = this.graph.getCell(preTar.id);\n        if (preTarget && 'port' in preTar) {\n            preTarget._clearInput(preTar.port);\n        }\n    },\n    _checkConnection() {\n        const tar = this.get('target');\n        const target = this.graph.getCell(tar.id);\n        this.set('warning', (target && target.getPort(tar.port).bits !== this.get('bits')) || false, {silent: !this._was_added});\n    },\n\n    /*\n     * Wire parameters for serialization.\n     */\n    getWireParams(layout) {\n        const connector = {\n            from: {\n                id: this.get('source').id,\n                port: this.get('source').port\n            },\n            to: {\n                id: this.get('target').id,\n                port: this.get('target').port\n            }\n        };\n        if (this.has('netname'))\n            connector.name = this.get('netname');\n        if (layout && this.has('vertices') && this.get('vertices').length > 0)\n            connector.vertices = _.cloneDeep(this.get('vertices'));\n        return connector;\n    },\n    getWirePath() {\n        const hier = [];\n        for (let sc = this.graph.get('subcircuit'); sc != null; sc = sc.graph.get('subcircuit')) {\n            if (!sc.has('label')) return null;\n            hier.push(sc.get('label'));\n        }\n        return hier.reverse();\n    }\n});\n\nexport const WireView = joint.dia.LinkView.extend({\n    initFlag: joint.dia.LinkView.prototype.initFlag.concat(['INIT']),\n    longWireLength: 400,\n    attrs: {\n        signal: {\n            high: { line: { 'stroke': '#03c03c' } },\n            low: { line: { 'stroke': '#fc7c68' } },\n            def: { line: { 'stroke': '#779ecb' } },\n            undef: { line: { 'stroke': '#999' } }\n        },\n        bits: {\n            bus: { line: { 'stroke-width': '4px' } },\n            single: { line: { 'stroke-width': '2px' } }\n        },\n        warning: {\n            warn: { wrapper: { 'stroke-opacity': '0.5' } },\n            none: { wrapper: { 'stroke-opacity': '0' } }\n        }\n    },\n    // only instantiate toolsView in browser-environment\n    _wireToolsView: (typeof window !== 'undefined') ? new joint.dia.ToolsView({\n        tools: [\n            new joint.linkTools.Vertices({ focusOpacity: 0.5 }),\n            //new joint.linkTools.Segments({ focusOpacity: 0.5 }), //todo: problem with signal reset ??,\n            new tools.CircleSourceArrowhead(),\n            new tools.CircleTargetArrowhead(),\n            new tools.RemoveButton({ distanceShort: '75%', distanceLong: '50' }),\n            new tools.RemoveButton({ distance: '-50', secondary: true }),\n            new tools.MonitorButton({ distanceShort: '25%', distanceLong: '30' }),\n            new tools.MonitorButton({ distance: '-30', secondary: true })\n        ]\n    }) : null,\n    presentationAttributes: joint.dia.LinkView.addPresentationAttributes({\n        signal: 'SIGNAL',\n        bits: 'BITS',\n        warning: 'WARNING'\n    }),\n    initialize() {\n        joint.dia.LinkView.prototype.initialize.apply(this, arguments);\n        this.prevModels = { source: null, target: null };\n    },\n    confirmUpdate(flags) {\n        joint.dia.LinkView.prototype.confirmUpdate.apply(this, arguments);\n        if (this.hasFlag(flags, 'SIGNAL')) {\n            this._updateSignal();\n        }\n        if (this.hasFlag(flags, 'BITS')) {\n            this._updateBits();\n        }\n        if (this.hasFlag(flags, 'WARNING')) {\n            this._updateWarning();\n        }\n    },\n\n    isShortWire() {\n        return this.getConnectionLength() < this.longWireLength;\n    },\n    _updateSignal() {\n        const signal = this.model.get('signal');\n        const attrs = this.attrs.signal[\n            !signal.isDefined ? 'undef' :\n            signal.isHigh ? 'high' :\n            signal.isLow ? 'low' : 'def'\n        ];\n        this._applyAttrs(attrs);\n    },\n    _updateBits() {\n        const bits = this.model.get('bits');\n        const attrs = this.attrs.bits[\n            bits > 1 ? 'bus' : 'single'\n        ];\n        this._applyAttrs(attrs);\n    },\n    _updateWarning() {\n        const warning = this.model.get('warning');\n        const attrs = this.attrs.warning[\n            warning ? 'warn' : 'none'\n        ];\n        this._applyAttrs(attrs);\n    },\n    _applyAttrs(attrs) {\n        for (const selector in attrs) {\n            const node = this.selectors[selector];\n            this.setNodeAttributes(node, attrs[selector]);\n        }\n    },\n\n    update() {\n        joint.dia.LinkView.prototype.update.apply(this, arguments);\n        this._updateSignal();\n        this._updateBits();\n        this._updateWarning();\n    },\n    onRemove() {\n        joint.dia.LinkView.prototype.onRemove.apply(this, arguments);\n        this._removeTooltip();\n    },\n\n    mouseenter(evt) {\n        joint.dia.LinkView.prototype.mouseenter.apply(this, arguments);\n        this.addTools(this._wireToolsView);\n        this._addTooltip({x: evt.clientX + 5, y: evt.clientY + 5 });\n    },\n    mouseleave(evt) {\n        joint.dia.LinkView.prototype.mouseleave.apply(this, arguments);\n        this.removeTools();\n        this._removeTooltip();\n    },\n\n    /*\n     * Display current value on wire in tooltip.\n     */\n    _addTooltip(pos) {\n        if (this.model.get('bits') == 1) return;\n        if (this.wire_hover) return;\n        this.wire_hover = $('<div class=\"wire_hover\">')\n            .css('left', pos.x)\n            .css('top', pos.y)\n            .appendTo($(document.body));\n        this._generateTextForTooltip();\n        this.listenTo(this.model, 'change:signal', this._generateTextForTooltip);\n    },\n    _removeTooltip() {\n        if (this.wire_hover) {\n            this.wire_hover.remove();\n            this.wire_hover = null;\n            this.stopListening(this.model, 'change:signal', this._generateTextForTooltip);\n        }\n    },\n    _generateTextForTooltip() {\n        if (!this.wire_hover) return;\n        const sig = this.model.get('signal');\n        const display3vl = this.model.graph._display3vl;\n        const hovertext = [\n            'Hex: ' + display3vl.show('hex', sig) + '<br>',\n            'Dec: ' + display3vl.show('dec', sig) + '<br>',\n            'Oct: ' + display3vl.show('oct', sig) + '<br>',\n            'Bin: ' + display3vl.show('bin', sig)\n        ].join('');\n        this.wire_hover.html(hovertext);\n    },\n\n    // Quick-and-dirty performance fix\n    onEndModelChange(endType, endModel, opt) {\n        if (typeof endModel == 'object' && endModel != null &&\n            endModel == this.prevModels[endType] &&\n            Object.keys(endModel.changed).length > 0 &&\n            !('position' in endModel.changed)) return;\n        joint.dia.LinkView.prototype.onEndModelChange.apply(this, arguments);\n        this.prevModels[endType] = endModel;\n    }\n});\n\n// base class for gates displayed as a box\nexport const Box = Gate.define('Box', {\n    attrs: {\n        body: { refWidth: 1, refHeight: 1 },\n        tooltip: { refX: 0, refY: -30, height: 30 }\n    }\n}, {\n    initialize() {\n        Gate.prototype.initialize.apply(this, arguments);\n        this.on('change:size', (_, size) => {\n            if (size.width > this.tooltipMinWidth) {\n                this.attr('tooltip', { refWidth: 1, width: null });\n            } else {\n                this.attr('tooltip', { refWidth: null, width: this.tooltipMinWidth });\n            }\n        });\n        this.trigger('change:size', this, this.prop('size'));\n    },\n    markup: Gate.prototype.markup.concat([{\n            tagName: 'rect',\n            className: 'body',\n            selector: 'body'\n        }\n    ]),\n    markupZoom: [{\n        tagName: 'foreignObject',\n        className: 'tooltip',\n        selector: 'tooltip',\n        children: [{\n            tagName: 'body',\n            namespaceURI: 'http://www.w3.org/1999/xhtml',\n            children: [{\n                tagName: 'a',\n                className: 'zoom',\n                textContent: '',\n                style: { cursor: 'pointer' }\n            }]\n        }]\n    }],\n    tooltipMinWidth: 20,\n    decorClock: 'M' + [\n                    [0, -6],\n                    [6, 0],\n                    [0, 6]\n                ].map(l => l.join(' ')).join(' L')\n});\n\nexport const BoxView = GateView.extend({\n    _autoResizeBox: false,\n    render() {\n        //todo: resize Box after port label / IO name / mode / bit size change\n        GateView.prototype.render.apply(this, arguments);\n        if (this._autoResizeBox && !this.model.get('box_resized')) {\n            this.model.set('box_resized', true);\n            this.model.prop('size/width', this._calculateBoxWidth());\n        }\n    },\n    _calculateBoxWidth() {\n        const leftlabels = Array.from(this.el.querySelectorAll('[port-group=in] > text.iolabel'));\n        const rightlabels = Array.from(this.el.querySelectorAll('[port-group=out] > text.iolabel'));\n        const leftwidth = Math.max(...leftlabels.map(x => x.getBBox().width));\n        const rightwidth = Math.max(...rightlabels.map(x => x.getBBox().width));\n        const fixup = x => x == -Infinity ? -5 : x;\n        const width = fixup(leftwidth) + fixup(rightwidth) + 25;\n        return width;\n    }\n});\n\n","\"use strict\";\n\nimport { Box, BoxView } from './base.mjs';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport { Vector3vl } from '3vl';\n\n// Things with numbers\nexport const NumBase = Box.define('NumBase', {\n    /* default properties */\n    numbase: 'hex',\n    bits: 1\n}, {\n    initialize() {\n        Box.prototype.initialize.apply(this, arguments);\n\n        this.on('change:bits', (_, bits) => {\n            const display3vl = this.graph._display3vl;\n            const displays = display3vl.usableDisplays(this.numbaseType, this.get('bits'));\n            if (!displays.includes(this.get('numbase')))\n                this.set('numbase', 'hex');\n        });\n    },\n    tooltipMinWidth: 70,\n    markupTooltip: [{\n        tagName: 'foreignObject',\n        className: 'tooltip',\n        selector: 'tooltip',\n        children: [{\n            tagName: 'body',\n            namespaceURI: 'http://www.w3.org/1999/xhtml',\n            children: [{\n                tagName: 'select',\n                className: 'numbase'\n            }]\n        }]\n    }],\n    _gateParams: Box.prototype._gateParams.concat(['numbase'])\n});\nexport const NumBaseView = BoxView.extend({\n    presentationAttributes: BoxView.addPresentationAttributes({\n        bits: 'BITS',\n        numbase: 'NUMBASE'\n    }),\n    _autoResizeBox: true,\n    events: {\n        \"click select.numbase\": \"stopprop\",\n        \"mousedown select.numbase\": \"stopprop\", // Prevent drag\n        \"touchstart select.numbase\": \"stopprop\", // Prevent drag & make sure select works\n        \"change select.numbase\": \"_changeNumbase\"\n    },\n    _changeNumbase(evt) {\n        this.model.set('numbase', evt.target.value || 'bin');\n    },\n    _calculateBoxWidth() {\n        const testtext = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n        $(testtext).text(Array(this.model.get('bits')).fill('0').join(''))\n            .attr('class', 'numvalue')\n            .appendTo(this.$el);\n        const width = testtext.getBBox().width + 20;\n        testtext.remove();\n        return width;\n    },\n    confirmUpdate(flags) {\n        BoxView.prototype.confirmUpdate.apply(this, arguments);\n        if (this.hasFlag(flags, 'BITS') || this.hasFlag(flags, 'RENDER'))\n            this._makeNumBaseSelector();\n        if (this.hasFlag(flags, 'NUMBASE'))\n            this._updateNumBaseSelector();\n    },\n    _makeNumBaseSelector() {\n        this.$('select.numbase').empty();\n        const numbase = this.model.get('numbase');\n        const display3vl = this.model.graph._display3vl;\n        for (const base of display3vl.usableDisplays(this.model.numbaseType, this.model.get('bits'))) {\n            const opt = $('<option>')\n                .attr('value', base)\n                .prop('selected', base == numbase)\n                .text(base)\n                .appendTo(this.$('select.numbase'));\n        }\n    },\n    _updateNumBaseSelector() {\n        this.$('select.numbase').val(this.model.get('numbase'));\n    }\n});\n\n// Input/output model\nexport const IO = NumBase.define('IO', {\n    /* default properties */\n    bits: 1,\n    net: '',\n    //as I/O has no delay, this is even not taken into account at all\n    propagation: 0,\n    /* 0 - within subcircuit, 1 - single-line, 2 - bus-line */\n    mode: -1,\n\n    attrs: {\n        ioname: {\n            refX: .5, refY: .5,\n            textAnchor: 'middle', textVerticalAnchor: 'middle',\n            fontWeight: 'bold',\n            fontSize: '10pt'\n        }\n    }\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        this.get('ports').items = [\n            { id: this._portDirection, group: this._portDirection, dir: this._portDirection, bits: bits }\n        ];\n\n        NumBase.prototype.initialize.apply(this, arguments);\n\n        this.on('change:bits', (_, bits) => {\n            const b = {};\n            b[this._portDirection] = bits;\n            this._setPortsBits(b);\n            if (this.get('mode') != 0) this._checkMode();\n        });\n        this.bindAttrToProp('ioname/text', 'net');\n    },\n    onAdd() {\n        this._checkMode();\n    },\n    _checkMode() {\n        // assumes graph to have subcircuit property before adding elements\n        const withinSubcircuit = this.graph && this.graph.has('subcircuit');\n        const bits = this.get('bits');\n        const mode = withinSubcircuit ? 0 : bits == 1 ? 1 : 2;\n\n        this.set('mode', mode);\n        this.set('box_resized', false);\n        this.set('markup', mode == 0 ? this.markupInSubcircuit :\n            mode == 1 ? this.markupSingle : this.markupBus\n        );\n        return mode;\n    },\n    _setPortsBits(portsBits) {\n        NumBase.prototype._setPortsBits.apply(this, arguments);\n\n        if (this.get('mode') != 0) return; // not inside a subcircuit\n        const subcir = this.graph.get('subcircuit');\n        console.assert(subcir != null);\n        const portsBitsSubcir = {};\n        portsBitsSubcir[this.get('net')] = portsBits[this._portDirection];\n        subcir._setPortsBits(portsBitsSubcir);\n    },\n    markupSingle: NumBase.prototype.markup,\n    markupBus: NumBase.prototype.markup.concat(NumBase.prototype.markupTooltip),\n    markupInSubcircuit: NumBase.prototype.markup.concat([{\n            tagName: 'text',\n            className: 'ioname',\n            selector: 'ioname'\n        }\n    ]),\n    _gateParams: NumBase.prototype._gateParams.concat(['bits','net','order'])\n});\nexport const IOView = NumBaseView.extend({\n    _calculateBoxWidth() {\n        switch (this.model.get('mode')) {\n            case 0:\n                // resize based on io name\n                const text = this.selectors['ioname'];\n                if (text.getAttribute('display') !== 'none') return text.getBBox().width + 10;\n                return 20;\n            case 1:\n                // resize to width = 30 (assumes height == 30 too)\n                return 30;\n            case 2:\n                // resize based on binary string\n                return NumBaseView.prototype._calculateBoxWidth.call(this);\n        }\n    }\n});\n\n// Input model\nexport const Input = IO.define('Input', {\n    attrs: {\n        btnface: {\n            stroke: 'black', strokeWidth: 2,\n            refX: .2, refY: .2,\n            refHeight: .6, refWidth: .6,\n            cursor: 'pointer'\n        },\n        valinput: {\n            refX: .5, refY: .5,\n            refWidth: -10, refHeight: -10,\n            xAlignment: 'middle', yAlignment: 'middle',\n        }\n    }\n}, {\n    isInput: true,\n    _portDirection: 'out',\n    _resetPortValue(port) {\n        if (port.id == \"out\" && port.dir == \"out\") {\n            const bits = this.get('bits');\n            const mode = this.get('mode');\n            return mode == 1 ? Vector3vl.zeros(bits) : Vector3vl.xes(bits);\n        } else return IO.prototype._resetPortValue.call(this, port);\n    },\n    _checkMode() {\n        IO.prototype._checkMode.call(this);\n        this._resetPortsSignals([this.get('ports').items[0]]);\n    },\n    setInput(sig) {\n        this._setInput(sig);\n        this.trigger('userChange', this);\n    },\n    toggleInput() {\n        this.setInput(this.get('outputSignals').out.not());\n    },\n    _setInput(sig) {\n        if (sig.bits != this.get('bits'))\n            throw new Error(\"setInput: wrong number of bits\");\n        this.set('outputSignals', { out: sig });\n    },\n    markupSingle: IO.prototype.markupSingle.concat([{\n            tagName: 'rect',\n            className: 'btnface',\n            selector: 'btnface'\n        }\n    ]),\n    markupBus: IO.prototype.markupBus.concat([{\n            tagName: 'foreignObject',\n            className: 'valinput',\n            selector: 'valinput',\n            children: [{\n                tagName: 'body',\n                namespaceURI: 'http://www.w3.org/1999/xhtml',\n                children: [{\n                    tagName: 'input',\n                    attributes: { type: 'text' }\n                }]\n            }]\n        }\n    ]),\n    numbaseType: 'read'\n});\nexport const InputView = IOView.extend({\n    attrs: _.merge({\n        button: {\n            high: { btnface: { 'fill': 'black' } },\n            low: { btnface: { 'fill': 'white' } }\n        }\n    }, IOView.prototype.attrs),\n    confirmUpdate(flags) {\n        IOView.prototype.confirmUpdate.apply(this, arguments);\n        if (this.hasFlag(flags, 'SIGNAL2') ||\n            this.hasFlag(flags, 'NUMBASE')) this._updateView();\n    },\n    _updateView() {\n        switch (this.model.get('mode')) {\n            case 1: this._updateButton(); break;\n            case 2: this._updateNumEntry(); break;\n        }\n    },\n    _updateButton() {\n        const signal = this.model.get('outputSignals').out;\n        const attrs = this.attrs.button[\n            signal.isHigh ? 'high' : 'low'\n        ];\n        this._applyAttrs(attrs);\n    },\n    _updateNumEntry() {\n        const display3vl = this.model.graph._display3vl;\n        this.$('input').val(display3vl.show(this.model.get('numbase'), this.model.get('outputSignals').out));\n        this.$('input').removeClass('invalid');\n    },\n    render() {\n        IOView.prototype.render.apply(this, arguments);\n        this._updateView();\n    },\n    events: _.merge({\n        //button\n        \"click .btnface\": \"_onButton\",\n        \"mousedown .btnface\": \"stopprop\", // Prevent drag\n        \"touchstart .btnface\": \"stopprop\", // Prevent drag & make sure click is generated\n        //numEntry\n        \"click input\": \"stopprop\",\n        \"mousedown input\": \"stopprop\", // Prevent drag\n        \"touchstart input\": \"stopprop\", // Prevent drag & make sure the input receives focus\n        \"change input\": \"_onNumEntry\"\n    }, NumBaseView.prototype.events),\n    _onButton() {\n        this.model.toggleInput();\n    },\n    _onNumEntry(evt) {\n        const numbase = this.model.get('numbase');\n        const bits = this.model.get('bits');\n        const display3vl = this.model.graph._display3vl;\n        if (display3vl.validate(numbase, evt.target.value, bits)) {\n            const val = display3vl.read(numbase, evt.target.value, bits);\n            this.model.setInput(val);\n        } else {\n            this.$('input').addClass('invalid');\n        }\n    }\n});\n\n// legacy special input models, now replaced by Input\nexport const Button = Input;\nexport const ButtonView = InputView;\nexport const NumEntry = Input;\nexport const NumEntryView = InputView;\n\n// Output model\nexport const Output = IO.define('Output', {\n    attrs: {\n        led: {\n            refX: .5, refY: .5, refR: .35\n        },\n        value: {\n            refX: .5, refY: .5,\n            textVerticalAnchor: 'middle',\n            text: '0'\n        }\n    }\n}, {\n    isOutput: true,\n    _portDirection: 'in',\n    getOutput() {\n        return this.get('inputSignals').in;\n    },\n    markupSingle: IO.prototype.markupSingle.concat([{\n            tagName: 'circle',\n            className: 'led',\n            selector: 'led'\n        }\n    ]),\n    markupBus: IO.prototype.markupBus.concat([{\n            tagName: 'text',\n            className: 'value numvalue',\n            selector: 'value'\n        }\n    ]),\n    numbaseType: 'show'\n});\nexport const OutputView = IOView.extend({\n    attrs: _.merge({\n        lamp: {\n            high: { led: { 'fill': '#03c03c' } },\n            low: { led: { 'fill': '#fc7c68' } },\n            undef: { led: { 'fill': '#bfc5c6' } }\n        }\n    }, IOView.prototype.attrs),\n    confirmUpdate(flags) {\n        IOView.prototype.confirmUpdate.apply(this, arguments);\n        if (this.hasFlag(flags, 'SIGNAL') ||\n            this.hasFlag(flags, 'NUMBASE')) this._updateView();\n    },\n    _updateView() {\n        switch (this.model.get('mode')) {\n            case 1: this._updateLamp(); break;\n            case 2: this._updateNumDisplay(); break;\n        }\n    },\n    _updateLamp() {\n        const signal = this.model.get('inputSignals').in;\n        const attrs = this.attrs.lamp[\n            signal.isHigh ? 'high' :\n            signal.isLow ? 'low' : 'undef'\n        ];\n        this._applyAttrs(attrs);\n    },\n    _updateNumDisplay() {\n        const display3vl = this.model.graph._display3vl;\n        this.$('text.value tspan').text(display3vl.show(this.model.get('numbase'), this.model.get('inputSignals').in));\n    },\n    render() {\n        IOView.prototype.render.apply(this, arguments);\n        this._updateView();\n    }\n});\n\n// legacy special output models, now replaced by Output\nexport const Lamp = Output;\nexport const LampView = OutputView;\n\nexport const NumDisplay = Output;\nexport const NumDisplayView = OutputView;\n\n// Constant\nexport const Constant = NumBase.define('Constant', {\n    /* default properties */\n    constant: '0',\n    propagation: 0,\n\n    attrs: {\n        value: {\n            refX: .5, refY: .5,\n            textVerticalAnchor: 'middle',\n            text: '0'\n        }\n    }\n}, {\n    initialize() {\n        const constant = this.get('constant');\n        const bits = constant.length;\n        this.set('bits', bits);\n        this.get('ports').items = [\n            { id: 'out', group: 'out', dir: 'out', bits: bits }\n        ];\n        \n        NumBase.prototype.initialize.apply(this, arguments);\n       \n        this.on('change:constant', (_, constant) => {\n            const bits = constant.length;\n            this._setPortsBits({ out: bits });\n            this.set('bits', bits);\n            this.set('constantCache', Vector3vl.fromBin(constant, bits));\n        });\n    },\n    prepare() {\n        const constant = this.get('constant');\n        const bits = constant.length;\n        this.set('constantCache', Vector3vl.fromBin(constant, bits));\n    },\n    operation() {\n        return { out: this.get('constantCache') };\n    },\n    markup: NumBase.prototype.markup.concat([{\n            tagName: 'text',\n            className: 'value numvalue',\n            selector: 'value'\n        }\n    ]),\n    _gateParams: NumBase.prototype._gateParams.concat(['constant']),\n    numbaseType: 'show'\n});\nexport const ConstantView = NumBaseView.extend({\n    presentationAttributes: NumBaseView.addPresentationAttributes({\n        constantCache: 'CONSTANT'\n    }),\n    confirmUpdate(flags) {\n        NumBaseView.prototype.confirmUpdate.apply(this, arguments);\n        if (this.hasFlag(flags, 'CONSTANT') ||\n            this.hasFlag(flags, 'NUMBASE')) this._showText();\n    },\n    _showText() {\n        const display3vl = this.model.graph._display3vl;\n        this.$('text.value tspan').text(display3vl.show(this.model.get('numbase'), this.model.get('constantCache')));\n    },\n    update() {\n        NumBaseView.prototype.update.apply(this, arguments);\n        this._showText();\n    }\n});\n\n// Clock\nexport const Clock = Box.define('Clock', {\n    /* default properties */\n    propagation: 100,\n\n    ports: {\n        items: [\n            { id: 'out', group: 'out', dir: 'out', bits: 1 }\n        ]\n    },\n\n    size: { width: 30, height: 30 }\n}, {\n    _resetPortValue(port) {\n        if (port.id == \"out\" && port.dir == \"out\") {\n            return Vector3vl.zero;\n        } else return Box.prototype._resetPortValue(port);\n    },\n    operation() {\n        // trigger next clock edge\n        return { out: this.get('outputSignals').out.not(), _clock_hack: true };\n    },\n    tooltipMinWidth: 55,\n    markup: Box.prototype.markup.concat([{\n            tagName: 'path',\n            className: 'decor',\n            attributes: { d: 'M7.5 7.5 L7.5 22.5 L15 22.5 L15 7.5 L22.5 7.5 L22.5 22.5', stroke: 'black' }\n        }, {\n            tagName: 'foreignObject',\n            className: 'tooltip',\n            selector: 'tooltip',\n            children: [{\n                tagName: 'body',\n                namespaceURI: 'http://www.w3.org/1999/xhtml',\n                children: [{\n                    tagName: 'input',\n                    attributes: { type: 'number', min: 1, step: 1 }\n                }]\n            }]\n        }\n    ]),\n    _unsupportedPropChanges: Box.prototype._unsupportedPropChanges.concat(['bits'])\n});\nexport const ClockView = BoxView.extend({\n    presentationAttributes: BoxView.addPresentationAttributes({\n        propagation: 'SIGNAL'\n    }),\n    events: {\n        \"click input\": \"stopprop\",\n        \"mousedown input\": \"stopprop\",\n        \"touchstart input\": \"stopprop\", // make sure the input receives focus\n        \"change input\": \"_changePropagation\",\n        \"input input\": \"_changePropagation\"\n    },\n    render(args) {\n        BoxView.prototype.render.apply(this, arguments);\n        this.updatePropagation();\n    },\n    confirmUpdate(flags) {\n        BoxView.prototype.confirmUpdate.apply(this, arguments);\n        if (this.hasFlag(flags, 'SIGNAL')) this.updatePropagation();\n    },\n    _changePropagation(evt) {\n        const val = evt.target.value;\n        const valid = String(val) == String(Number(val));\n        if (valid) this.model.set('propagation', Number(val) || 1);\n        this.$('input').toggleClass('invalid', !valid);\n    },\n    updatePropagation() {\n        this.$('input').val(this.model.get('propagation'));\n    }\n});\n\n","\"use strict\";\n\nimport { Gate, GateView } from './base.mjs';\n\nconst and_path = \"M19 0v32h16c9 0 16-7 16-16S44 0 35 0H20z\";\nconst or_path = \"M14.3 0l1.6 2s4.5 5.6 4.5 14s-4.5 14-4.5 14l-1.6 2H28c3.8 0 16.6-.5 25-16h0A28 28 0 0028 0H16.8z\";\nconst buf_path = \"M18-2v36l2-1 32-17h0L20-1z\";\nconst xor_arc_path = \"M6.8-1.2 10 2.7S14.2 8 14.2 16S10 29.3 10 29.3l-3.2 3.9H10l1.7-2.4s4.8-6 4.8-14.8c0-8.9-4.8-14.8-4.8-14.8l-1.7-2.4z\";\n    \nconst xor_arc_path_markup = {\n    tagName: 'path',\n    selector: 'xor_arc',\n    attributes: {\n        'fill': \"#000\",\n        'd': xor_arc_path\n    }\n};\n\nconst neg_markup = {\n    tagName: 'circle',\n    className: 'body',\n    selector: 'neg_bubble',\n    attributes: {\n        'stroke': \"#000\",\n        'stroke-width': '2px',\n        'cx': 56,\n        'cy': 16,\n        'r': 4\n    }\n};\n\nfunction gateMarkup(children = []) {\n    return {\n        tagName: 'g',\n        selector: 'body',\n        children: [\n            {\n                tagName: 'path',\n                className: 'body gate',\n                selector: 'gate'\n            }\n        ].concat(children)\n    }\n}\n\n// base class for gates\nexport const GateSVG = Gate.define('GateSVG', {\n    /* default properties */\n    bits: 1,\n\n    size: { width: 60, height: 32 },\n    ports: {\n        groups: {\n            'in': { position: { name: 'left', args: { dx: 30 } }, attrs: { wire: { x2: -50 }, port: { refX: -50 } }, z: -1 },\n            'out': { position: { name: 'right', args: { dx: -30 } }, attrs: { wire: { x2: 50 }, port: { refX: 50 } }, z: -1 }\n        }\n    }\n}, {\n    markup: Gate.prototype.markup.concat([gateMarkup()]),\n    _gateParams: Gate.prototype._gateParams.concat(['bits'])\n});\n\n// Single-input gate model\nexport const Gate11 = GateSVG.define('Gate11', {}, {\n    initialize() {\n        const bits = this.get('bits');\n        this.get('ports').items = [\n            { id: 'in', group: 'in', dir: 'in', bits: bits },\n            { id: 'out', group: 'out', dir: 'out', bits: bits }\n        ];\n        \n        GateSVG.prototype.initialize.apply(this, arguments);\n        \n        this.on('change:bits', (_, bits) => {\n            this._setPortsBits({ in: bits, out: bits });\n        });\n    }\n});\n\n// Multi-input gate model\nexport const GateX1 = GateSVG.define('GateX1', {\n    /* default properties */\n    inputs: 2,\n\n    attrs: {\n        gate: {\n            'vector-effect': 'non-scaling-stroke'\n        },\n        xor_arc: {\n            'vector-effect': 'non-scaling-stroke'\n        },\n        neg_bubble: {\n            'vector-effect': 'non-scaling-stroke'\n        }\n    }\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        const inputs = this.get('inputs');\n\n        const ports = [];\n        for (let i = 1; i <= inputs; i++)\n            ports.push({ id: 'in' + i, group: 'in', dir: 'in', bits: bits });\n        ports.push({ id: 'out', group: 'out', dir: 'out', bits: bits });\n        this.get('ports').items = ports;\n        const scaling = inputs / 2;\n        this.set('size', { width: 60 * scaling, height: 32 * scaling });\n        this.attr('body/transform', 'translate(-4, 0) scale('+scaling+')');\n\n        this.prop('ports/groups/in/position/args/dx', 30 * scaling);\n        this.prop('ports/groups/in/attrs/wire/x2', -30 * scaling - 20);\n        this.prop('ports/groups/in/attrs/port/refX', -30 * scaling - 20);\n        this.prop('ports/groups/out/position/args/dx', -30 * scaling);\n        this.prop('ports/groups/out/attrs/wire/x2', 30 * scaling + 20);\n        this.prop('ports/groups/out/attrs/port/refX', 30 * scaling + 20);\n\n        GateSVG.prototype.initialize.apply(this, arguments);\n        \n        this.on('change:bits', (_, bits) => {\n            const inputs = this.get('inputs');\n            const param = { out: bits };\n            for (let i = 1; i <= inputs; i++)\n                param['in' + i] = bits;\n            this._setPortsBits(param);\n        });\n    },\n    operation(data) {\n        let ret = data.in1;\n        for (let i = 2; i <= this.get('inputs'); i++)\n            ret = this.binoperation(ret, data['in' + i]);\n        return { out: this.finoperation(ret) };\n    },\n    finoperation(val) {\n        return val\n    },\n    _gateParams: GateSVG.prototype._gateParams.concat(['inputs']),\n    _unsupportedPropChanges: GateSVG.prototype._unsupportedPropChanges.concat(['inputs']),\n    _operationHelpers: GateSVG.prototype._operationHelpers.concat(['binoperation', 'finoperation'])\n});\n\n// Reducing gate model\nexport const GateReduce = GateSVG.define('GateReduce', {}, {\n    initialize() {\n        const bits = this.get('bits');\n        this.get('ports').items = [\n            { id: 'in', group: 'in', dir: 'in', bits: bits },\n            { id: 'out', group: 'out', dir: 'out', bits: 1 }\n        ];\n        \n        GateSVG.prototype.initialize.apply(this, arguments);\n        \n        this.on('change:bits', (_, bits) => {\n            this._setPortsBits({ in: bits });\n        });\n    }\n});\n\n// Repeater (buffer) gate model\nexport const Repeater = Gate11.define('Repeater', {\n    attrs: { gate: { d: buf_path }}\n}, {\n    operation(data) {\n        return { out: data.in };\n    }\n});\nexport const RepeaterView = GateView;\n\n// Not gate model\nexport const Not = Gate11.define('Not', {\n    attrs: { gate: { d: buf_path }}\n}, {\n    operation(data) {\n        return { out: data.in.not() };\n    },\n    markup: Gate.prototype.markup.concat([gateMarkup([neg_markup])]),\n});\nexport const NotView = GateView;\n\n// Or gate model\nexport const Or = GateX1.define('Or', {\n    attrs: { gate: { d: or_path }}\n}, {\n    binoperation(in1, in2) {\n        return in1.or(in2);\n    }\n});\nexport const OrView = GateView;\n\n// And gate model\nexport const And = GateX1.define('And', {\n    attrs: { gate: { d: and_path }}\n}, {\n    binoperation(in1, in2) {\n        return in1.and(in2);\n    }\n});\nexport const AndView = GateView;\n\n// Nor gate model\nexport const Nor = GateX1.define('Nor', {\n    attrs: { gate: { d: or_path }}\n}, {\n    binoperation(in1, in2) {\n        return in1.or(in2);\n    },\n    finoperation(val) {\n        return val.not();\n    },\n    markup: Gate.prototype.markup.concat([gateMarkup([neg_markup])]),\n});\nexport const NorView = GateView;\n\n// Nand gate model\nexport const Nand = GateX1.define('Nand', {\n    attrs: { gate: { d: and_path }}\n}, {\n    binoperation(in1, in2) {\n        return in1.and(in2);\n    },\n    finoperation(val) {\n        return val.not();\n    },\n    markup: Gate.prototype.markup.concat([gateMarkup([neg_markup])]),\n});\nexport const NandView = GateView;\n\n// Xor gate model\nexport const Xor = GateX1.define('Xor', {\n    attrs: { gate: { d: or_path }}\n}, {\n    binoperation(in1, in2) {\n        return in1.xor(in2);\n    },\n    markup: Gate.prototype.markup.concat([gateMarkup([xor_arc_path_markup])]),\n});\nexport const XorView = GateView;\n\n// Xnor gate model\nexport const Xnor = GateX1.define('Xnor', {\n    attrs: { gate: { d: or_path }}\n}, {\n    binoperation(in1, in2) {\n        return in1.xor(in2);\n    },\n    finoperation(val) {\n        return val.not();\n    },\n    markup: Gate.prototype.markup.concat([gateMarkup([xor_arc_path_markup, neg_markup])]),\n});\nexport const XnorView = GateView;\n\n// Reducing Or gate model\nexport const OrReduce = GateReduce.define('OrReduce', {\n    attrs: { gate: { d: or_path }}\n}, {\n    operation(data) {\n        return { out: data.in.reduceOr() };\n    }\n});\nexport const OrReduceView = GateView;\n\n// Reducing Nor gate model\nexport const NorReduce = GateReduce.define('NorReduce', {\n    attrs: { gate: { d: or_path }}\n}, {\n    operation(data) {\n        return { out: data.in.reduceNor() };\n    },\n    markup: GateReduce.prototype.markup.concat([neg_markup])\n});\nexport const NorReduceView = GateView;\n\n// Reducing And gate model\nexport const AndReduce = GateReduce.define('AndReduce', {\n    attrs: { gate: { d: and_path }}\n}, {\n    operation(data) {\n        return { out: data.in.reduceAnd() };\n    }\n});\nexport const AndReduceView = GateView;\n\n// Reducing Nand gate model\nexport const NandReduce = GateReduce.define('NandReduce', {\n    attrs: { gate: { d: and_path }}\n}, {\n    operation(data) {\n        return { out: data.in.reduceNand() };\n    },\n    markup: Gate.prototype.markup.concat([gateMarkup([neg_markup])]),\n});\nexport const NandReduceView = GateView;\n\n// Reducing Xor gate model\nexport const XorReduce = GateReduce.define('XorReduce', {\n    attrs: { gate: { d: or_path }}\n}, {\n    operation(data) {\n        return { out: data.in.reduceXor() };\n    },\n    markup: Gate.prototype.markup.concat([gateMarkup([xor_arc_path_markup])]),\n});\nexport const XorReduceView = GateView;\n\n// Reducing Xnor gate model\nexport const XnorReduce = GateReduce.define('XnorReduce', {\n    attrs: { gate: { d: or_path }}\n}, {\n    operation(data) {\n        return { out: data.in.reduceXnor() };\n    },\n    markup: Gate.prototype.markup.concat([gateMarkup([xor_arc_path_markup, neg_markup])]),\n});\nexport const XnorReduceView = GateView;\n\n","\"use strict\";\n\nimport { Gate, GateView } from './base.mjs';\nimport { Vector3vl } from '3vl';\n\nfunction isSafeInteger(v) {\n    return v <= Number.MAX_SAFE_INTEGER && v >= -Number.MAX_SAFE_INTEGER;\n}\n\n// base class for arithmetic operations displayed with a circle\nexport const Arith = Gate.define('Arith', {\n    size: { width: 40, height: 40 },\n    attrs: {\n        body: { refR: 0.5, refCx: 0.5, refCy: 0.5 },\n        oper: {\n            refX: .5, refY: .5,\n            textAnchor: 'middle', textVerticalAnchor: 'middle',\n            fontSize: '12pt'\n        }\n    },\n    ports: {\n        groups: {\n            'in': { position: { name: 'left', args: { dx: 10 } }, attrs: { wire: { x2: -35 }, port: { refX: -35 } }, z: -1 },\n            'out': { position: { name: 'right', args: { dx: -10 } }, attrs: { wire: { x2: 35 }, port: { refX: 35 } }, z: -1 }\n        }\n    }\n}, {\n    markup: Gate.prototype.markup.concat([{\n            tagName: 'circle',\n            className: 'body',\n            selector: 'body'\n        }, {\n            tagName: 'text',\n            className: 'oper',\n            selector: 'oper'\n        }\n    ]),\n    _gateParams: Gate.prototype._gateParams.concat(['bits', 'signed']),\n    _unsupportedPropChanges: Gate.prototype._unsupportedPropChanges.concat(['signed'])\n});\n\n// Unary arithmetic operations\nexport const Arith11 = Arith.define('Arith11', {\n    /* default properties */\n    bits: { in: 1, out: 1 },\n    signed: false\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        this.get('ports').items = [\n            { id: 'in', group: 'in', dir: 'in', bits: bits.in },\n            { id: 'out', group: 'out', dir: 'out', bits: bits.out }\n        ];\n        \n        Arith.prototype.initialize.apply(this, arguments);\n        \n        this.on('change:bits', (_,bits) => {\n            this._setPortsBits(bits);\n        });\n    },\n    operation(data) {\n        const bits = this.get('bits');\n        if (!data.in.isFullyDefined)\n            return { out: Vector3vl.xes(bits.out) };\n        return {\n            out: Vector3vl.fromNumber(this.arithop(data.in.toBigInt(this.get('signed'))), bits.out)\n        };\n    },\n    _operationHelpers: Arith.prototype._operationHelpers.concat(['arithop'])\n});\n\n// Binary arithmetic operations\nexport const Arith21 = Arith.define('Arith21', {\n    /* default properties */\n    bits: { in1: 1, in2: 1, out: 1 },\n    signed: { in1: false, in2: false }\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        this.get('ports').items = [\n            { id: 'in1', group: 'in', dir: 'in', bits: bits.in1 },\n            { id: 'in2', group: 'in', dir: 'in', bits: bits.in2 },\n            { id: 'out', group: 'out', dir: 'out', bits: bits.out }\n        ];\n        \n        Arith.prototype.initialize.apply(this, arguments);\n        \n        this.on('change:bits', (_, bits) => {\n            this._setPortsBits(bits);\n        });\n    },\n    operation(data) {\n        const bits = this.get('bits');\n        const sgn = this.get('signed');\n        if (!data.in1.isFullyDefined || !data.in2.isFullyDefined)\n            return { out: Vector3vl.xes(bits.out) };\n        return {\n            out: Vector3vl.fromNumber(this.arithop(\n                    data.in1.toBigInt(sgn.in1 && sgn.in2),\n                    data.in2.toBigInt(sgn.in1 && sgn.in2)), bits.out)\n        };\n    },\n    _operationHelpers: Arith.prototype._operationHelpers.concat(['arithop'])\n});\n\nfunction shiftHelp(in1, am, bits_in, bits_out, sgn_in, sgn_out, fillx) {\n    const signbit = in1.get(in1.bits-1);\n    const ext = Vector3vl.make(Math.max(0, bits_out - bits_in),\n        fillx ? 0 : sgn_in ? signbit : -1);\n    const my_in = in1.concat(ext);\n    const out = am < 0\n        ? Vector3vl.make(-am, fillx ? 0 : -1).concat(my_in)\n        : my_in.slice(am).concat(Vector3vl.make(am, fillx ? 0 : sgn_out ? my_in.get(my_in.bits-1) : -1));\n    return out.slice(0, bits_out);\n}\n\n// Bit shift operations\nexport const Shift = Arith.define('Shift', {\n    /* default properties */\n    bits: { in1: 1, in2: 1, out: 1 },\n    signed: { in1: false, in2: false, out: false },\n    fillx: false\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        this.get('ports').items = [\n            { id: 'in1', group: 'in', dir: 'in', bits: bits.in1 },\n            { id: 'in2', group: 'in', dir: 'in', bits: bits.in2 },\n            { id: 'out', group: 'out', dir: 'out', bits: bits.out }\n        ];\n        \n        Arith.prototype.initialize.apply(this, arguments);\n        \n        this.on('change:bits', (_, bits) => {\n            this._setPortsBits(bits);\n        });\n    },\n    operation(data) {\n        const bits = this.get('bits');\n        const sgn = this.get('signed');\n        const fillx = this.get('fillx');\n        if (!data.in2.isFullyDefined)\n            return { out: Vector3vl.xes(bits.out) };\n        const am = data.in2.toNumber(sgn.in2) * this.shiftdir;\n        return { out: shiftHelp(data.in1, am, bits.in1, bits.out, sgn.in1, sgn.out, fillx) };\n    },\n    _gateParams: Arith.prototype._gateParams.concat(['fillx']),\n    _unsupportedPropChanges: Arith.prototype._unsupportedPropChanges.concat(['fillx']),\n    _operationHelpers: Arith.prototype._operationHelpers.concat(['shiftdir'])\n});\n\n// Comparison operations\nexport const BaseCompare = Arith.define('BaseCompare', {\n    /* default properties */\n    bits: { in1: 1, in2: 1 },\n    signed: { in1: false, in2: false }\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        this.get('ports').items = [\n            { id: 'in1', group: 'in', dir: 'in', bits: bits.in1 },\n            { id: 'in2', group: 'in', dir: 'in', bits: bits.in2 },\n            { id: 'out', group: 'out', dir: 'out', bits: 1 }\n        ];\n        \n        Arith.prototype.initialize.apply(this, arguments);\n        \n        this.on('change:bits', (_, bits) => {\n            this._setPortsBits(bits);\n        });\n    }\n});\n\n// Arithmetic comparison operations\nexport const Compare = BaseCompare.define('Compare', {}, {\n    operation(data) {\n        const bits = this.get('bits');\n        const sgn = this.get('signed');\n        if (!data.in1.isFullyDefined || !data.in2.isFullyDefined)\n            return { out: Vector3vl.xes(1) };\n        return {\n            out: Vector3vl.fromBool(this.arithcomp(\n                    data.in1.toBigInt(sgn.in1 && sgn.in2),\n                    data.in2.toBigInt(sgn.in1 && sgn.in2)))\n        };\n    },\n    _operationHelpers: BaseCompare.prototype._operationHelpers.concat(['arithcomp'])\n});\n\n// Equality operations\nexport const EqCompare = BaseCompare.define('EqCompare', {}, {\n    operation(data) {\n        const bits = this.get('bits');\n        const sgn = this.get('signed');\n        const in1 = bits.in1 >= bits.in2 ? data.in1 : \n            data.in1.concat(Vector3vl.make(bits.in2 - bits.in1, sgn.in1 && sgn.in2 ? data.in1.msb : -1));\n        const in2 = bits.in2 >= bits.in1 ? data.in2 : \n            data.in2.concat(Vector3vl.make(bits.in1 - bits.in2, sgn.in1 && sgn.in2 ? data.in2.msb : -1));\n        return {\n            out: this.bincomp(in1, in2)\n        };\n    },\n    _operationHelpers: BaseCompare.prototype._operationHelpers.concat(['bincomp'])\n});\n\n// Negation\nexport const Negation = Arith11.define('Negation', {\n    attrs: {\n        oper: { text: '-' }\n    }\n}, {\n    arithop: i => -i\n});\nexport const NegationView = GateView;\n\n// Unary plus\nexport const UnaryPlus = Arith11.define('UnaryPlus', {\n    attrs: {\n        oper: { text: '+' }\n    }\n}, {\n    arithop: i => i\n});\nexport const UnaryPlusView = GateView;\n\n// Addition\nexport const Addition = Arith21.define('Addition', {\n    attrs: {\n        oper: { text: '+' }\n    }\n}, {\n    arithop: (i, j) => i + j\n});\nexport const AdditionView = GateView;\n\n// Subtraction\nexport const Subtraction = Arith21.define('Subtraction', {\n    attrs: {\n        oper: { text: '-' }\n    }\n}, {\n    arithop: (i, j) => i - j\n});\nexport const SubtractionView = GateView;\n\n// Multiplication\nexport const Multiplication = Arith21.define('Multiplication', {\n    attrs: {\n        oper: { text: '' }\n    }\n}, {\n    arithop: (i, j) => i * j\n});\nexport const MultiplicationView = GateView;\n\n// Division\nexport const Division = Arith21.define('Division', {\n    attrs: {\n        oper: { text: '' }\n    }\n}, {\n    arithop: (i, j) => j == 0n ? i : i / j // as in IEEE Verilog\n});\nexport const DivisionView = GateView;\n\n// Modulo\nexport const Modulo = Arith21.define('Modulo', {\n    attrs: {\n        oper: { text: '%' }\n    }\n}, {\n    arithop: (i, j) => j == 0n ? i : i % j // as in IEEE Verilog\n});\nexport const ModuloView = GateView;\n\n// Power\nexport const Power = Arith21.define('Power', {\n    attrs: {\n        oper: { text: '^' }\n    }\n}, {\n    arithop: (i, j) => j >= 0n ? i ** j : i == 1n ? 1n : i == -1n ? (j % 2n ? -1n : 1n) : 0n\n});\nexport const PowerView = GateView;\n\n// Shift left operator\nexport const ShiftLeft = Shift.define('ShiftLeft', {\n    attrs: {\n        oper: { text: '' }\n    }\n}, {\n    shiftdir: -1\n});\nexport const ShiftLeftView = GateView;\n\n// Shift right operator\nexport const ShiftRight = Shift.define('ShiftRight', {\n    attrs: {\n        oper: { text: '' }\n    }\n}, {\n    shiftdir: 1\n});\nexport const ShiftRightView = GateView;\n\n// Less than operator\nexport const Lt = Compare.define('Lt', {\n    attrs: {\n        oper: { text: '<' }\n    }\n}, {\n    arithcomp: (i, j) => i < j\n});\nexport const LtView = GateView;\n\n// Less or equal operator\nexport const Le = Compare.define('Le', {\n    attrs: {\n        oper: { text: '' }\n    }\n}, {\n    arithcomp: (i, j) => i <= j\n});\nexport const LeView = GateView;\n\n// Greater than operator\nexport const Gt = Compare.define('Gt', {\n    attrs: {\n        oper: { text: '>' }\n    }\n}, {\n    arithcomp: (i, j) => i > j\n});\nexport const GtView = GateView;\n\n// Less than operator\nexport const Ge = Compare.define('Ge', {\n    attrs: {\n        oper: { text: '' }\n    }\n}, {\n    arithcomp: (i, j) => i >= j\n});\nexport const GeView = GateView;\n\n// Equality operator\nexport const Eq = EqCompare.define('Eq', {\n    attrs: {\n        oper: { text: '=' }\n    }\n}, {\n    bincomp: (i, j) => i.xnor(j).reduceAnd()\n});\nexport const EqView = GateView;\n\n// Nonequality operator\nexport const Ne = EqCompare.define('Ne', {\n    attrs: {\n        oper: { text: '' }\n    }\n}, {\n    bincomp: (i, j) => i.xor(j).reduceOr()\n});\nexport const NeView = GateView;\n\nexport const OpConst = Arith.define('OpConst', {\n    leftOp: false,\n    constant: 0\n}, {\n    initialize() {\n        Arith.prototype.initialize.apply(this, arguments);\n\n        let constant = this.get('constant');\n        if (typeof constant === 'string' || constant instanceof String) {\n            constant = BigInt(constant);\n            if (isSafeInteger(constant))\n                constant = Number(constant);\n            this.set('constant', constant);\n        }\n        const genLabel = () => {\n            const constantSize = String(this.get('constant')).length;\n            const diameter = 30 + constantSize * 10;\n            this.prop(\"size\", { width: diameter, height: diameter });\n            this.attr(\"oper/text\", \n                this.get('leftOp') ? this.get('constant') + this.operSymbol\n                                   : this.operSymbol + this.get('constant'))\n        };\n        genLabel();\n\n        this.on('change:bits', (_, bits) => {\n            this._setPortsBits(bits);\n        });\n        this.on('change:constant', () => genLabel());\n        this.on('change:leftOp', () => genLabel());\n    },\n    getGateParams() {\n        const params = Arith.prototype.getGateParams.apply(this, arguments);\n        // `constant` may be a bigint and we need to encode it manually\n        if (typeof params.constant === 'bigint') {\n            if (isSafeInteger(params.constant)) {\n                params.constant = Number(params.constant);\n            }\n            else {\n                params.constant = String(params.constant);\n            }\n        }\n        return params;\n    },\n    _gateParams: Arith.prototype._gateParams.concat(['leftOp', 'constant'])\n});\n\n// Arithmetic operations fused with constants\nexport const ArithConst = OpConst.define('ArithConst', {\n    /* default properties */\n    bits: { in: 1, out: 1 },\n    signed: false\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        this.get('ports').items = [\n            { id: 'in', group: 'in', dir: 'in', bits: bits.in },\n            { id: 'out', group: 'out', dir: 'out', bits: bits.out }\n        ];\n        \n        OpConst.prototype.initialize.apply(this, arguments);\n    },\n    operation(data) {\n        const bits = this.get('bits');\n        const sgn = this.get('signed');\n        const constant = this.get('constant');\n        if (!data.in.isFullyDefined)\n            return { out: Vector3vl.xes(bits.out) };\n        if (this.get('leftOp'))\n            return {\n                out: Vector3vl.fromNumber(this.arithop(\n                    BigInt(constant),\n                    data.in.toBigInt(sgn.in)), bits.out)\n            }\n        else\n            return {\n                out: Vector3vl.fromNumber(this.arithop(\n                    data.in.toBigInt(sgn.in), BigInt(constant)), bits.out)\n            };\n    },\n    _operationHelpers: OpConst.prototype._operationHelpers.concat(['arithop'])\n});\n\n// Bit shift operations fused with constants\nexport const ShiftConst = OpConst.define('ShiftConst', {\n    /* default properties */\n    bits: { in: 1, out: 1 },\n    signed: { in: false, out: false },\n    fillx: false\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        this.get('ports').items = [\n            { id: 'in', group: 'in', dir: 'in', bits: bits.in },\n            { id: 'out', group: 'out', dir: 'out', bits: bits.out }\n        ];\n        \n        OpConst.prototype.initialize.apply(this, arguments);\n    },\n    operation(data) {\n        const bits = this.get('bits');\n        const sgn = this.get('signed');\n        const fillx = this.get('fillx');\n        const constant = this.get('constant');\n        if (this.get('leftOp')) {\n            if (!data.in.isFullyDefined)\n                return { out: Vector3vl.xes(bits.out) };\n            const am = data.in.toNumber(sgn.in);\n            const sig = Vector3vl.fromNumber(constant);\n            return { \n                out: shiftHelp(sig, am * this.shiftdir, sig.bits, bits.out, constant < 0, sgn.out, fillx) \n            };\n        } else {\n            console.assert(isSafeInteger(constant));\n            return {\n                out: shiftHelp(data.in, Number(constant) * this.shiftdir, bits.in, bits.out, sgn.in, sgn.out, fillx)\n            };\n        }\n    },\n    _gateParams: OpConst.prototype._gateParams.concat(['fillx']),\n    _operationHelpers: OpConst.prototype._operationHelpers.concat(['shiftdir'])\n});\n\n// Comparison operations fused with constants\nexport const BaseCompareConst = OpConst.define('BaseCompareConst', {\n    /* default properties */\n    bits: { in: 1 },\n    signed: false\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        this.get('ports').items = [\n            { id: 'in', group: 'in', dir: 'in', bits: bits.in },\n            { id: 'out', group: 'out', dir: 'out', bits: 1 }\n        ];\n        \n        OpConst.prototype.initialize.apply(this, arguments);\n    }\n});\n\n// Arithmetic comparisons fused with constants\nexport const CompareConst = BaseCompareConst.define('CompareConst', {}, {\n    operation(data) {\n        const bits = this.get('bits');\n        const sgn = this.get('signed');\n        const constant = this.get('constant');\n        if (!data.in.isFullyDefined)\n            return { out: Vector3vl.x };\n        if (this.get('leftOp'))\n            return {\n                out: Vector3vl.fromBool(this.arithcomp(\n                    BigInt(constant),\n                    data.in.toBigInt(sgn.in)))\n            }\n        else\n            return {\n                out: Vector3vl.fromBool(this.arithcomp(\n                    data.in.toBigInt(sgn.in), \n                    BigInt(constant)))\n            };\n    },\n    _operationHelpers: BaseCompareConst.prototype._operationHelpers.concat(['arithcomp'])\n});\n\n// Equality operations fused with constants\nexport const EqCompareConst = BaseCompareConst.define('EqCompareConst', {}, {\n    operation(data) {\n        const bits = this.get('bits');\n        const sgn = this.get('signed');\n        const constant = this.get('constant');\n        if (this.get('leftOp'))\n            return {\n                out: this.bincomp(Vector3vl.fromNumber(constant, bits.in), data.in)\n            };\n        else\n            return {\n                out: this.bincomp(data.in, Vector3vl.fromNumber(constant, bits.in))\n            };\n    },\n    _operationHelpers: BaseCompareConst.prototype._operationHelpers.concat(['bincomp'])\n});\n\n// Addition with constant\nexport const AdditionConst = ArithConst.define('AdditionConst', {}, {\n    operSymbol: '+',\n    arithop: (i, j) => i + j\n});\nexport const AdditionConstView = GateView;\n\n// Subtraction with constant\nexport const SubtractionConst = ArithConst.define('SubtractionConst', {}, {\n    operSymbol: '-',\n    arithop: (i, j) => i - j\n});\nexport const SubtractionConstView = GateView;\n\n// Multiplication with constant\nexport const MultiplicationConst = ArithConst.define('MultiplicationConst', {}, {\n    operSymbol: '',\n    arithop: (i, j) => i * j\n});\nexport const MultiplicationConstView = GateView;\n\n// Division with constant\nexport const DivisionConst = ArithConst.define('DivisionConst', {}, {\n    operSymbol: '',\n    arithop: (i, j) => j == 0n ? i : i / j // as in IEEE Verilog\n});\nexport const DivisionConstView = GateView;\n\n// Modulo with constant\nexport const ModuloConst = ArithConst.define('ModuloConst', {}, {\n    operSymbol: '%',\n    arithop: (i, j) => j == 0n ? i : i % j // as in IEEE Verilog\n});\nexport const ModuloConstView = GateView;\n\n// Power with constant\nexport const PowerConst = ArithConst.define('PowerConst', {}, {\n    operSymbol: '^',\n    arithop: (i, j) => j >= 0n ? i ** j : i == 1n ? 1n : i == -1n ? (j % 2n ? -1n : 1n) : 0n\n});\nexport const PowerConstView = GateView;\n\n// Shift left operator\nexport const ShiftLeftConst = ShiftConst.define('ShiftLeftConst', {}, {\n    operSymbol: '',\n    shiftdir: -1\n});\nexport const ShiftLeftConstView = GateView;\n\n// Shift right operator\nexport const ShiftRightConst = ShiftConst.define('ShiftRightConst', {}, {\n    operSymbol: '',\n    shiftdir: 1\n});\nexport const ShiftRightConstView = GateView;\n\n// Less than operator\nexport const LtConst = CompareConst.define('LtConst', {}, {\n    operSymbol: '<',\n    arithcomp: (i, j) => i < j\n});\nexport const LtConstView = GateView;\n\n// Less than operator\nexport const LeConst = CompareConst.define('LeConst', {}, {\n    operSymbol: '',\n    arithcomp: (i, j) => i <= j\n});\nexport const LeConstView = GateView;\n\n// Less than operator\nexport const GtConst = CompareConst.define('GtConst', {}, {\n    operSymbol: '>',\n    arithcomp: (i, j) => i > j\n});\nexport const GtConstView = GateView;\n\n// Less than operator\nexport const GeConst = CompareConst.define('GeConst', {}, {\n    operSymbol: '',\n    arithcomp: (i, j) => i >= j\n});\nexport const GeConstView = GateView;\n\n// Equality operator\nexport const EqConst = EqCompareConst.define('EqConst', {}, {\n    operSymbol: '=',\n    bincomp: (i, j) => i.xnor(j).reduceAnd()\n});\nexport const EqConstView = GateView;\n\n// Nonequality operator\nexport const NeConst = EqCompareConst.define('NeConst', {}, {\n    operSymbol: '',\n    bincomp: (i, j) => i.xor(j).reduceOr()\n});\nexport const NeConstView = GateView;\n\n","\"use strict\";\n\nimport { Box, BoxView } from './base.mjs';\nimport { Vector3vl } from '3vl';\n\n// Bit extending\nexport const BitExtend = Box.define('BitExtend', {\n    /* default properties */\n    extend: { input: 1, output: 1 },\n    propagation: 0,\n    \n    attrs: {\n        value: {\n            refX: .5, refY: .5,\n            textAnchor: 'middle', textVerticalAnchor: 'middle'\n        }\n    }\n}, {\n    initialize() {\n        const extend = this.get('extend');\n        console.assert(extend.input <= extend.output);\n        this.get('ports').items = [\n            { id: 'in', group: 'in', dir: 'in', bits: extend.input },\n            { id: 'out', group: 'out', dir: 'out', bits: extend.output }\n        ];\n        \n        Box.prototype.initialize.apply(this, arguments);\n        \n        this.on('change:extend', (_, extend) => {\n            this._setPortsBits({ in: extend.input, out: extend.output });\n        });\n    },\n    operation(data) {\n        const ex = this.get('extend');\n        return { out: data.in.concat(Vector3vl.make(ex.output - ex.input, this._extBit(data.in))) };\n    },\n    markup: Box.prototype.markup.concat([{\n            tagName: 'text',\n            className: 'value',\n            selector: 'value'\n        }\n    ]),\n    _gateParams: Box.prototype._gateParams.concat(['extend']),\n    _operationHelpers: Box.prototype._operationHelpers.concat(['_extBit'])\n});\nexport const BitExtendView = BoxView.extend({\n    _autoResizeBox: true,\n    _calculateBoxWidth() {\n        const text = this.el.querySelector('text.value');\n        return text.getBBox().width + 10;\n    }\n});\n\nexport const ZeroExtend = BitExtend.define('ZeroExtend', {\n    attrs: {\n        value: { text: 'zero-extend' }\n    }\n}, {\n    _extBit(i) {\n        return -1;\n    }\n});\nexport const ZeroExtendView = BitExtendView;\n\nexport const SignExtend = BitExtend.define('SignExtend', {\n    attrs: {\n        value: { text: 'sign-extend' }\n    }\n}, {\n    _extBit(i) {\n        return i.get(i.bits - 1);\n    }\n});\nexport const SignExtendView = BitExtendView;\n\n// Bus slicing\nexport const BusSlice = Box.define('BusSlice', {\n    /* default properties */\n    slice: { first: 0, count: 1, total: 2 },\n    propagation: 0,\n    \n    size: { width: 40, height: 24 }\n}, {\n    initialize() {\n        const slice = this.get('slice');\n        \n        const val = slice.count == 1 ? slice.first : \n            slice.first + \"-\" + (slice.first + slice.count - 1);\n        \n        this.get('ports').items = [\n            { id: 'in', group: 'in', dir: 'in', bits: slice.total },\n            { id: 'out', group: 'out', dir: 'out', bits: slice.count, portlabel: val, labelled: true }\n        ];\n        \n        Box.prototype.initialize.apply(this, arguments);\n        \n        this.on('change:slice', (_, slice) => {\n            this._setPortsBits({ in: slice.total, out: slice.count });\n        });\n    },\n    operation(data) {\n        const s = this.get('slice');\n        return { out: data.in.slice(s.first, s.first + s.count) };\n    },\n    _gateParams: Box.prototype._gateParams.concat(['slice'])\n});\nexport const BusSliceView = BoxView.extend({\n    _autoResizeBox: true\n});\n\n// Bus grouping\nexport const BusRegroup = Box.define('BusRegroup', {\n    /* default properties */\n    groups: [1],\n    propagation: 0,\n\n    size: { width: 40, height: undefined }\n}, {\n    initialize() {\n        var bits = 0;\n        const ports = [];\n        const groups = this.get('groups');\n        \n        this.get('size').height = groups.length*16+8;\n        \n        for (const [num, gbits] of groups.entries()) {\n            const lbl = bits + (gbits > 1 ? '-' + (bits + gbits - 1) : '');\n            bits += gbits;\n            ports.push({ id: this.group_dir + num, group: this.group_dir, dir: this.group_dir, bits: gbits, portlabel: lbl, labelled: true });\n        }\n        this.set('bits', bits);\n        \n        const contra = this.group_dir == 'out' ? 'in' : 'out';\n        ports.push({ id: contra, group: contra, dir: contra, bits: bits });\n        this.get('ports').items = ports;\n        \n        Box.prototype.initialize.apply(this, arguments);\n    },\n    _gateParams: Box.prototype._gateParams.concat(['groups']),\n    _unsupportedPropChanges: Box.prototype._unsupportedPropChanges.concat(['groups'])\n});\nexport const BusRegroupView = BoxView.extend({\n    _autoResizeBox: true\n});\n\nexport const BusGroup = BusRegroup.define('BusGroup', {\n}, {\n    group_dir : 'in',\n    operation(data) {\n        const outdata = [];\n        for (const num of this.get('groups').keys()) {\n            outdata.push(data['in' + num]);\n        }\n        return { out : Vector3vl.concat(...outdata) };\n    }\n});\nexport const BusGroupView = BusRegroupView;\n\nexport const BusUngroup = BusRegroup.define('BusUngroup', {\n}, {\n    group_dir : 'out',\n    operation(data) {\n        const outdata = {};\n        let pos = 0;\n        for (const [num, gbits] of this.get('groups').entries()) {\n            outdata['out' + num] = data.in.slice(pos, pos + gbits);\n            pos += gbits;\n        }\n        return outdata;\n    }\n});\nexport const BusUngroupView = BusRegroupView;\n\n","\"use strict\";\n\nimport * as joint from '@joint/core';\nimport _ from 'lodash';\nimport { Box, BoxView } from './base.mjs';\nimport { IO, Input, Output } from './io.mjs';\n\n// add offset of 10pt to account for the top label at layout time\nconst subcircuit_pos_offset = 10;\nconst subcircuit_size_offset = 10;\n\n// Subcircuit model -- embeds a circuit graph in an element\nexport const Subcircuit = Box.define('Subcircuit', {\n    /* default properties */\n    propagation: 0,\n    warning: false,\n\n    attrs: {\n        wrapper: {\n            refWidth: 1, refHeight: 1,\n            stroke: 'red', strokeWidth: 10\n        },\n        type: {\n            refX: .5, refY: -10,\n            textAnchor: 'middle', textVerticalAnchor: 'middle',\n            fontSize: '8pt'\n        }\n    }\n}, {\n    initialize() {\n        this.bindAttrToProp('type/text', 'celltype');\n\n        const graph = this.get('graph');\n        console.assert(graph instanceof joint.dia.Graph);\n        graph.set('subcircuit', this);\n        const IOs = graph.getCells()\n            .filter((cell) => cell instanceof IO);\n        const inputs = IOs.filter((cell) => cell instanceof Input);\n        const outputs = IOs.filter((cell) => cell instanceof Output);\n        function sortfun(x, y) {\n            if (x.has('order') || y.has('order'))\n                return x.get('order') - y.get('order');\n            return x.get('net').localeCompare(y.get('net'));\n        }\n        inputs.sort(sortfun);\n        outputs.sort(sortfun);\n        const vcount = Math.max(inputs.length, outputs.length);\n        const size = { width: 80, height: vcount*16+8 };\n        const ports = [], iomap = {};\n        for (const [num, io] of inputs.entries()) {\n            ports.push({ id: io.get('net'), group: 'in', dir: 'in', bits: io.get('bits'), labelled: true });\n        }\n        for (const [num, io] of outputs.entries()) {\n            ports.push({ id: io.get('net'), group: 'out', dir: 'out', bits: io.get('bits'), labelled: true });\n        }\n        for (const io of IOs) {\n            iomap[io.get('net')] = io.get('id');\n        }\n        this.set('size', size);\n        this.set('circuitIOmap', iomap);\n        this.get('ports').items = ports;\n        this.set('warning', graph._warnings > 0);\n\n        Box.prototype.initialize.apply(this, arguments);\n    },\n    _resetPortValue(port) {\n        const iomap = this.get('circuitIOmap');\n        const graph = this.get('graph');\n        if (port.dir == 'in')\n            return graph.getCell(iomap[port.id]).get('outputSignals').out;\n        if (port.dir == 'out')\n            return graph.getCell(iomap[port.id]).get('inputSignals').in;\n        return Box.prototype._resetPortValue.call(this, port);\n    },\n    getLayoutSize() {\n        const size = this.size();\n        size.height += subcircuit_size_offset;\n        return size;\n    },\n    setLayoutPosition(position) {\n        this.set('position', {\n            x: position.x,\n            y: position.y + subcircuit_pos_offset\n        });\n    },\n    getPortsPositions() {\n        const positions = Box.prototype.getPortsPositions.apply(this, arguments);\n        const res = {};\n        for (const id in positions) {\n            res[id] = { ...positions[id] };\n            res[id].y = res[id].y + subcircuit_pos_offset;\n        }\n        return res;\n    },\n    markup: [{\n            tagName: 'rect',\n            selector: 'wrapper'\n        }\n    ].concat(Box.prototype.markup, [{\n            tagName: 'text',\n            className: 'type',\n            selector: 'type'\n        }\n    ], Box.prototype.markupZoom),\n    _gateParams: Box.prototype._gateParams.concat(['celltype']),\n    _unsupportedPropChanges: Box.prototype._unsupportedPropChanges.concat(['celltype'])\n});\n\nexport const SubcircuitView = BoxView.extend({\n    attrs: _.merge({}, BoxView.prototype.attrs, {\n        warning: {\n            warn: { wrapper: { 'stroke-opacity': '0.5' } },\n            none: { wrapper: { 'stroke-opacity': '0' } }\n        }\n    }),\n    _autoResizeBox: true,\n    presentationAttributes: BoxView.addPresentationAttributes({\n        warning: 'WARNING'\n    }),\n    confirmUpdate(flags) {\n        BoxView.prototype.confirmUpdate.apply(this, arguments);\n        if (this.hasFlag(flags, 'WARNING')) {\n            this._updateWarning();\n        }\n    },\n    _updateWarning() {\n        const warning = this.model.get('warning');\n        const attrs = this.attrs.warning[\n            warning ? 'warn' : 'none'\n        ];\n        this._applyAttrs(attrs);\n    },\n    update() {\n        BoxView.prototype.update.apply(this, arguments);\n        this._updateWarning();\n    },\n    events: {\n        \"click foreignObject.tooltip\": \"stopprop\",\n        \"mousedown foreignObject.tooltip\": \"stopprop\",\n        \"touchstart foreignObject.tooltip\": \"stopprop\", // make sure the input receives focus\n        \"click a.zoom\": \"zoomInCircuit\"\n    },\n    zoomInCircuit(evt) {\n        evt.stopPropagation();\n        this.paper.trigger('open:subcircuit', this.model);\n        return false;\n    }\n});\n\n","\"use strict\";\n\nimport _ from 'lodash';\nimport { Gate, GateView, portGroupAttrs } from './base.mjs';\nimport { Vector3vl } from '3vl';\n\n// add offset of 30pt to account for the top selection port and oversized box at layout time\nconst mux_pos_offset = 20;\nconst mux_size_offset = 30;\n\n// Multiplexers\nexport const GenMux = Gate.define('GenMux', {\n    /* default properties */\n    bits: { in: 1, sel: 1 },\n    \n    size: { width: 40, height: undefined },\n    ports: {\n        groups: {\n            'in2': {\n                position: { name: 'top', args: { y: 5 } },\n                attrs: _.merge({}, portGroupAttrs, {\n                    wire: { x2: 0, y2: -25 },\n                    port: { magnet: 'passive', refY: -25 },\n                    bits: { refDx: -5, refDy: 2, textAnchor: 'start' }\n                }),\n                z: -1\n            }\n        }\n    },\n    attrs: { label: { refDy: 8 } }\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        const ports = [\n            { id: 'sel', group: 'in2', dir: 'in', bits: bits.sel },\n            { id: 'out', group: 'out', dir: 'out', bits: bits.in }\n        ];\n        \n        const ins = this.muxInputs(bits.sel);\n        this.get('size').height = ins.length*16+8;\n        \n        const vpath = [\n            [2, 0],\n            [5, 5],\n            [10, -5]\n        ];\n        const path = 'M' + vpath.map(l => l.join(' ')).join(' L');\n        \n        for (const [num, label] of ins.entries()) {\n            const port = { id: 'in' + num, group: 'in', dir: 'in', bits: bits.in, decor: path };\n            if (label) {\n                port.portlabel = String(label);\n                port.labelled = true;\n            }\n            ports.push(port);\n        }\n        \n        this.get('ports').items = ports;\n        \n        Gate.prototype.initialize.apply(this, arguments);\n        \n        const drawBorder = (size) => this.attr(['body', 'points'], \n            [[0,-5],[size.width,5],[size.width,size.height-5],[0,size.height+5]]\n                .map(x => x.join(',')).join(' '));\n        drawBorder(this.get('size'));\n        \n        this.on('change:size', (_, size) => drawBorder(size));\n    },\n    operation(data) {\n        const i = this.muxInput(data.sel);\n        if (i === undefined) return { out: Vector3vl.xes(this.get('bits').in) };\n        return { out: data['in' + i] };\n    },\n    getLayoutSize() {\n        const size = this.size();\n        size.height += mux_size_offset;\n        return size;\n    },\n    setLayoutPosition(position) {\n        this.set('position', {\n            x: position.x,\n            y: position.y + mux_pos_offset\n        });\n    },\n    getPortsPositions() {\n        const positions = Gate.prototype.getPortsPositions.apply(this, arguments);\n        const res = {};\n        for (const id in positions) {\n            res[id] = { ...positions[id] };\n            res[id].y = res[id].y + mux_pos_offset;\n        }\n        return res;\n    },\n    markup: Gate.prototype.markup.concat([{\n            tagName: 'polygon',\n            className: 'body',\n            selector: 'body'\n        }\n    ]),\n    _gateParams: Gate.prototype._gateParams.concat(['bits']),\n    _unsupportedPropChanges: Gate.prototype._unsupportedPropChanges.concat(['bits']),\n    _operationHelpers: Gate.prototype._operationHelpers.concat(['muxInput'])\n});\nexport const GenMuxView = GateView.extend({\n    initialize() {\n        this.ins = this.model.muxInputs(this.model.get('bits').sel);\n        GateView.prototype.initialize.apply(this, arguments);\n    },\n    confirmUpdate(flags) {\n        GateView.prototype.confirmUpdate.apply(this, arguments);\n        if (this.hasFlag(flags, 'SIGNAL')) {\n            this._updateMux(this.model.get('inputSignals'));\n        }\n    },\n    render() {\n        GateView.prototype.render.apply(this, arguments);\n        this._updateMux(this.model.get('inputSignals'));\n    },\n    _updateMux(data) {\n        const i = this.model.muxInput(data.sel);\n        for (const num of this.ins.keys()) {\n            this.$('[port=in' + num + '] path.decor').css('visibility', i == num ? 'visible' : 'hidden');\n        }\n    }\n});\n\n// Multiplexer with binary selection\nexport const Mux = GenMux.define('Mux', {\n}, {\n    muxInputs: n => Array(1 << n),\n    muxInput: i => i.isFullyDefined ? i.toBigInt().toString() : undefined\n});\nexport const MuxView = GenMuxView;\n\n// Multiplexer with one-hot selection\nexport const Mux1Hot = GenMux.define('Mux1Hot', {\n    attrs: {\n        info: {\n            refX: .5, refY: .5,\n            textAnchor: 'middle', textVerticalAnchor: 'middle',\n            text: '1Hot',\n            transform: 'rotate(90)'\n        }\n    }\n}, {\n    markup: GenMux.prototype.markup.concat([{\n            tagName: 'text',\n            className: 'info',\n            selector: 'info'\n        }\n    ]),\n    muxInputs: n => Array(n + 1),\n    muxInput: s => {\n        const i = s.toArray();\n        return s.isFullyDefined && i.filter(x => x == 1).length <= 1\n            ? String(i.indexOf(1)+1) : undefined\n    }\n});\nexport const Mux1HotView = GenMuxView;\n\nexport const MuxSparse = GenMux.define('MuxSparse', {\n    /* default properties */\n    inputs: undefined,\n    default_input: false\n}, {\n    initialize() {\n        const inputs = this.get('inputs');\n        for (let i = 0; i < inputs.length; i++)\n            if (typeof inputs[i] != 'bigint')\n                inputs[i] = BigInt(inputs[i]);\n        GenMux.prototype.initialize.apply(this, arguments);\n    },\n    muxInputs(n) {\n        if (this.get('default_input'))\n            return ['*'].concat(this.get('inputs'))\n        else\n            return this.get('inputs');\n    },\n    muxInput(i) {\n        const deflt = this.get('default_input');\n        if (!i.isFullyDefined) return undefined;\n        const idx = this.get('inputs').indexOf(i.toBigInt());\n        return idx < 0 ? (deflt ? 0 : undefined) : (deflt ? idx + 1 : idx);\n    },\n    _gateParams: GenMux.prototype._gateParams.concat(['inputs', 'default_input']),\n    _unsupportedPropChanges: GenMux.prototype._unsupportedPropChanges.concat(['inputs', 'default_input'])\n});\nexport const MuxSparseView = GenMuxView;\n\n","\"use strict\";\n\nimport { Box, BoxView } from './base.mjs';\nimport { Vector3vl } from '3vl';\n\n// D flip-flops\nexport const Dff = Box.define('Dff', {\n    /* default properties */\n    bits: 1,\n    initial: 'x',\n\n    size: { width: 80, height: undefined },\n    ports: {\n        groups: {\n            'in': {\n                position: Box.prototype._getStackedPosition({ side: 'left' })\n            },\n            'out': {\n                position: Box.prototype._getStackedPosition({ side: 'right' })\n            }\n        }\n    }\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        const initial = this.get('initial');\n        const polarity = this.get('polarity') || {};\n        \n        const ports = [];\n       \n        if (!this.get('no_data'))\n            ports.push({ id: 'in', group: 'in', dir: 'in', bits: bits, portlabel: 'D', labelled: true });\n        ports.push({ id: 'out', group: 'out', dir: 'out', bits: bits, portlabel: 'Q', labelled: true });\n        \n        if ('arst' in polarity && !this.get('arst_value'))\n            this.set('arst_value', Array(bits).fill('0').join(''));\n        \n        if ('srst' in polarity && !this.get('srst_value'))\n            this.set('srst_value', Array(bits).fill('0').join(''));\n\n        let num = 1;\n        if ('aload' in polarity) {\n            num += 2;\n            ports.push({ id: 'ain', group: 'in', dir: 'in', bits: bits, portlabel: 'AD', labelled: true });\n            ports.push({ id: 'aload', group: 'in', dir: 'in', bits: 1, polarity: polarity.aload, labelled: true });\n        }\n        if ('clock' in polarity) {\n            num++;\n            ports.push({ id: 'clk', group: 'in', dir: 'in', bits: 1, polarity: polarity.clock, decor: Box.prototype.decorClock, labelled: true });\n        }\n        if ('set' in polarity) {\n            num++;\n            ports.push({ id: 'set', group: 'in', dir: 'in', bits: bits, polarity: polarity.set, portlabel: 'S', labelled: true });\n        }\n        if ('clr' in polarity) {\n            num++;\n            ports.push({ id: 'clr', group: 'in', dir: 'in', bits: bits, polarity: polarity.clr, portlabel: 'R', labelled: true });\n        }\n        if ('srst' in polarity) {\n            num++;\n            ports.push({ id: 'srst', group: 'in', dir: 'in', bits: 1, polarity: polarity.srst, labelled: true });\n        }\n        if ('arst' in polarity) {\n            num++;\n            ports.push({ id: 'arst', group: 'in', dir: 'in', bits: 1, polarity: polarity.arst, labelled: true });\n        }\n        if ('enable' in polarity) {\n            num++;\n            ports.push({ id: 'en', group: 'in', dir: 'in', bits: 1, polarity: polarity.enable, labelled: true });\n        }\n        \n        this.get('size').height = num*16+8;\n        this.get('ports').items = ports;\n        this.last_clk = 0;\n        \n        Box.prototype.initialize.apply(this, arguments);\n    },\n    _resetPortValue(port) {\n        if (port.id == \"out\" && port.dir == \"out\")\n            return Vector3vl.fromBin(this.get('initial'), port.bits);\n        else return Box.prototype._resetPortValue.call(this, port);\n    },\n    operation(data) {\n        const polarity = this.get('polarity');\n        const pol = what => polarity[what] ? 1 : -1\n        let last_clk, srbits, srbitmask;\n        const apply_sr = (v) => ({out: srbits ? v.and(srbitmask).or(srbits) : v});\n        if ('clock' in polarity) {\n            last_clk = this.last_clk;\n            this.last_clk = data.clk.get(0);\n        }\n        if ('arst' in polarity && data.arst.get(0) == pol('arst'))\n            return { out: Vector3vl.fromBin(this.get('arst_value'), this.get('bits')) };\n        if ('aload' in polarity && data.aload.get(0) == pol('aload'))\n            return { out: data.ain };\n        if ('set' in polarity) {\n            srbits = polarity.set ? data.set : data.set.not();\n            srbitmask = polarity.set ? data.set.not() : data.set;\n        }\n        if ('clr' in polarity) {\n            srbits = srbits ? srbits : Vector3vl.zeros(this.get('bits'));\n            const clrbitmask = polarity.clr ? data.clr.not() : data.clr;\n            srbitmask = srbitmask ? clrbitmask.and(srbitmask) : clrbitmask;\n        }\n        if ('enable' in polarity && data.en.get(0) != pol('enable') && this.get('enable_srst'))\n            return apply_sr(this.get('outputSignals').out);\n        if (!('clock' in polarity) || data.clk.get(0) == pol('clock') && last_clk == -pol('clock')) {\n            if ('srst' in polarity && data.srst.get(0) == pol('srst'))\n                return apply_sr(Vector3vl.fromBin(this.get('srst_value'), this.get('bits')));\n            if ('enable' in polarity && data.en.get(0) != pol('enable') && !this.get('enable_srst'))\n                return apply_sr(this.get('outputSignals').out);\n            if (this.get('no_data'))\n                return apply_sr(this.get('outputSignals').out);\n            return apply_sr(data.in);\n        } else return apply_sr(this.get('outputSignals').out);\n    },\n    _gateParams: Box.prototype._gateParams.concat(['polarity', 'bits', 'initial', 'arst_value', 'srst_value', 'enable_srst', 'no_data']),\n    _unsupportedPropChanges: Box.prototype._unsupportedPropChanges.concat(['polarity', 'bits', 'initial', 'arst_value', 'srst_value', 'enable_srst', 'no_data'])\n});\nexport const DffView = BoxView.extend({\n    _autoResizeBox: true\n});\n\n","\"use strict\";\n\nimport { Vector3vl, Display3vlWithRegex } from '3vl';\n\nconst controlCodes20 = [\n    'NUL', 'SOH', 'STX', 'ETX', 'EOT', 'ENQ', 'ACK', 'BEL', \n    'BS',  'HT',  'LF',  'VT',  'FF',  'CR',  'SO',  'SI', \n    'DLE', 'DC1', 'DC2', 'DC3', 'DC4', 'NAK', 'SYN', 'ETB',\n    'CAN', 'EM',  'SUB', 'ESC', 'FS',  'GS',  'RS',  'US',\n    'SP',  'DEL'];\n\nexport class Display3vlASCII extends Display3vlWithRegex {\n    constructor() {\n        super('[\\x20-\\x7e\\xa0-\\xff\\ufffd\\u2400-\\u2421]|' + controlCodes20.join('|'))\n    }\n    get name() {\n        return \"ascii\";\n    }\n    get sort() {\n        return 1;\n    }\n    can(kind, bits) {\n        return bits == 7 || bits == 8;\n    }\n    read(data, bits) {\n        if (data.length == 1) {\n            const code = data.charCodeAt(0);\n            if (code == 0xfffd) return Vector3vl.xes(bits);\n            if (code == 0x2421) return Vector3vl.fromHex(\"7f\", bits);\n            if (code >= 0x2400 && code <= 0x2420) \n                return Vector3vl.fromHex((code - 0x2400).toString(16), bits);\n            return Vector3vl.fromHex(code.toString(16), bits);\n        } else {\n            const code = controlCodes20.indexOf(data);\n            if (code < 0) return Vector3vl.xes(bits);\n            if (code == 0x21) return Vector3vl.fromHex(\"7f\", bits);\n            return Vector3vl.fromHex(code.toString(16), bits);\n        }\n    }\n    show(data) {\n        if (!data.isFullyDefined) return \"\\ufffd\";\n        const code = parseInt(data.toHex(), 16);\n        if (code <= 0x20) {\n            return String.fromCharCode(0x2400 + code);\n        }\n        if (code == 0x7f) return \"\\u2421\";\n        if (code > 0x7f && code < 0xa0) {\n            return \"\\ufffd\";\n        }\n        return String.fromCharCode(code);\n    }\n    size(bits) {\n        return 1;\n    }\n}\n\n        \nexport function baseSelectMarkupHTML(display3vl, bits, base) { \n    const markup = display3vl.usableDisplays('read', bits)\n        .map(n => '<option value=\"' + n + '\"' + (n == base ? ' selected=\"selected\"' : '') +'>' + n + '</option>');\n    return '<select name=\"base\">' + markup.join(\"\") + '</select>';\n};\n\nexport function eqSigs(sigs1, sigs2) {\n    for (const k in sigs2) {\n        if (!sigs1[k].eq(sigs2[k])) return false;\n    }\n    return true;\n};\n\n","\"use strict\";\n\nimport $ from 'jquery';\nimport _ from 'lodash';\nimport { Box, BoxView } from './base.mjs';\nimport * as help from '../help.mjs';\nimport { Vector3vl, Mem3vl } from '3vl';\n\n// Memory cell\nexport const Memory = Box.define('Memory', {\n    /* default properties */\n    bits: 1,\n    abits: 1,\n    rdports: [],\n    wrports: [],\n    words: undefined,\n    offset: 0,\n    \n    attrs: {\n        portsplit: {\n            stroke: 'black'\n        }\n    },\n    ports: {\n        groups: {\n            'in': {\n                position: Box.prototype._getStackedPosition({ side: 'left' })\n            },\n            'out': {\n                position: Box.prototype._getStackedPosition({ side: 'right' })\n            }\n        }\n    }\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        const abits = this.get('abits');\n        const rdports = this.get('rdports');\n        const wrports = this.get('wrports');\n        \n        let num = 0;\n        let idxOffset = 0;\n        const ports = [], portsplits = [];\n        for (const [portname, port] of this._memrdports()) {\n            ports.push(\n                { id: portname + 'addr', group: 'in', dir: 'in', bits: abits, portlabel: 'addr', labelled: true },\n                { id: portname + 'data', group: 'out', dir: 'out', bits: bits, portlabel: 'data', labelled: true, args: { idxOffset: idxOffset } }\n            );\n            num += 1;\n            if ('srst_polarity' in port) {\n                num++;\n                idxOffset++;\n                ports.push({ id: portname + 'srst', group: 'in', dir: 'in', bits: 1, portlabel: 'srst', polarity: port.srst_polarity, labelled: true });\n            }\n            if ('arst_polarity' in port) {\n                num++;\n                idxOffset++;\n                ports.push({ id: portname + 'arst', group: 'in', dir: 'in', bits: 1, portlabel: 'arst', polarity: port.arst_polarity, labelled: true });\n            }\n            if ('enable_polarity' in port) {\n                num++;\n                idxOffset++;\n                ports.push({ id: portname + 'en', group: 'in', dir: 'in', bits: 1, portlabel: 'en', polarity: port.enable_polarity, labelled: true });\n            }\n            if ('clock_polarity' in port) {\n                num++;\n                idxOffset++;\n                ports.push({ id: portname + 'clk', group: 'in', dir: 'in', bits: 1, portlabel: 'clk', polarity: port.clock_polarity, decor: Box.prototype.decorClock, labelled: true });\n            }\n            portsplits.push(num);\n        }\n        for (const [portname, port] of this._memwrports()) {\n            num += 2;\n            ports.push(\n                { id: portname + 'data', group: 'in', dir: 'in', bits: bits, portlabel: 'data', labelled: true },\n                { id: portname + 'addr', group: 'in', dir: 'in', bits: abits, portlabel: 'addr', labelled: true }\n            );\n            if ('enable_polarity' in port) {\n                num++;\n                ports.push({ id: portname + 'en', group: 'in', dir: 'in', bits: port.no_bit_enable ? 1 : bits, portlabel: 'en', polarity: port.enable_polarity, labelled: true });\n            }\n            if ('clock_polarity' in port) {\n                num++;\n                ports.push({ id: portname + 'clk', group: 'in', dir: 'in', bits: 1, portlabel: 'clk', polarity: port.clock_polarity, decor: Box.prototype.decorClock, labelled: true });\n            }\n            portsplits.push(num);\n        }\n        portsplits.pop();\n        this.get('size').height = num*16+8;\n        this.get('ports').items = ports;\n        \n        Box.prototype.initialize.apply(this, arguments);\n        \n        this.removeProp('memdata'); // performance hack\n        \n        this.on('change:size', (_, size) => {\n            // only adapting to changed width\n            const path = [];\n            for (const num of portsplits) {\n                path.push([\n                    [0, 16*num + 4],\n                    [size.width, 16*num + 4]\n                ].map(p => p.join(' ')).join(' L '));\n            }\n            this.attr('path.portsplit/d', 'M ' + path.join(' M '));\n        });\n    },\n    _resetPortValue(port) {\n        if (port.dir == \"out\") {\n            const res = /^rd([0-9]+)data$/.exec(port.id);\n            const portdata = res ? this.get('rdports')[res[1]] : {};\n            if ('init_value' in portdata)\n                return Vector3vl.fromBin(portdata.init_value, port.bits);\n        }\n        return Box.prototype._resetPortValue.call(this, port);\n    },\n    prepare() {\n        const bits = this.get('bits');\n        var words = this.get('words');\n        const memdata = this.get('memdata');\n        \n        if (!words) {\n            words = 1 << this.get('abits');\n            this.prop('words', words, { init: true });\n        }\n        if (memdata)\n            this.memdata = Mem3vl.fromJSON(bits, memdata);\n        else\n            this.memdata = new Mem3vl(bits, words);\n        console.assert(this.memdata.words == words);\n        \n        this.last_clk = {};\n        for (const [portname, port] of this._memports()) {\n            if ('clock_polarity' in port)\n                this.last_clk[portname + 'clk'] = 0;\n        }\n    },\n    operation(data) {\n        const bits = this.get('bits');\n        const out = {};\n        const pol = (port, what) => port[what + '_polarity'] ? 1 : -1;\n        const is_enabled = (portname, port) => {\n            if ('enable_polarity' in port && !data[portname + 'en'].toArray().some(x => x == pol(port, 'enable')))\n                return false;\n            return true;\n        };\n        const port_active = (portname, port) => {\n            const clkname = portname + 'clk';\n            if ('clock_polarity' in port) {\n                return (data[clkname].get(0) == pol(port, 'clock') && this.last_clk[clkname] == -pol(port, 'clock'));\n            }\n            return true;\n        };\n        const valid_addr = n => n >= 0 && n < this.get('words');\n        const do_comb_read = (portname, port) => {\n            const addr = this._calcaddr(data[portname + 'addr']);\n            if (valid_addr(addr))\n                out[portname + 'data'] = this.memdata.get(addr);\n            else\n                out[portname + 'data'] = Vector3vl.xes(bits);\n        };\n        const write_value = (portname, port, oldval, val) => {\n            if (port.no_bit_enable || !('enable_polarity' in port))\n                return val;\n            const mask = port.enable_polarity ? data[portname + 'en'] : data[portname + 'en'].not();\n            return val.and(mask).or(oldval.and(mask.not()));\n        };\n        const do_read = (portname, port) => {\n            do_comb_read(portname, port);\n            for (const [num, wrport] of this.get('wrports').entries()) {\n                const wrportname = 'wr' + num;\n                const mask_ok = (val, num) => typeof val == 'boolean' ? val : val[num];\n                if ('transparent' in port && mask_ok(port.transparent, num) && port_active(wrportname, wrport) && is_enabled(wrportname, wrport) && data[portname + 'addr'] == data[wrportname + 'addr'])\n                    out[portname + 'data'] = write_value(wrportname, wrport, out[portname + 'data'], data[wrportname + 'data']);\n                if ('collision' in port && mask_ok(port.collision, num) && port_active(wrportname, wrport) && is_enabled(wrportname, wrport) && data[portname + 'addr'] == data[wrportname + 'addr'])\n                    out[portname + 'data'] = write_value(wrportname, wrport, out[portname + 'data'], Vector3vl.xes(bits));\n            }\n\n        };\n        const do_write = (portname, port) => {\n            const addr = this._calcaddr(data[portname + 'addr']);\n            if (valid_addr(addr)) {\n                const oldval = this.memdata.get(addr);\n                const newval = write_value(portname, port, oldval, data[portname + 'data']);\n                const changed = !oldval.eq(newval);\n                this.memdata.set(addr, newval);\n                if (changed)\n                    this.trigger(\"memChange\", addr, newval);\n            }\n        };\n        const do_srst = (portname, port) => {\n            if (data[portname + 'srst'].get(0) == pol(port, 'srst'))\n                out[portname + 'data'] = 'srst_value' in port\n                                       ? Vector3vl.fromBin(port.srst_value, bits)\n                                       : Vector3vl.zeros(bits);\n        };\n        const do_arst = (portname, port) => {\n            if (data[portname + 'arst'].get(0) == pol(port, 'arst'))\n                out[portname + 'data'] = 'arst_value' in port\n                                       ? Vector3vl.fromBin(port.arst_value, bits)\n                                       : Vector3vl.zeros(bits);\n        };\n        const update_last_clk = (portname, port) => {\n            if ('clock_polarity' in port) {\n                const clkname = portname + 'clk';\n                this.last_clk[clkname] = data[clkname].get(0);\n            }\n        };\n        for (const [portname, port] of this._memrdports()) {\n            out[portname + 'data'] = this.get('outputSignals')[portname + 'data'];\n            if ('clock_polarity' in port && is_enabled(portname, port) && port_active(portname, port))\n                do_read(portname, port);\n        }\n        for (const [portname, port] of this._memwrports())\n            if (is_enabled(portname, port) && port_active(portname, port))\n                do_write(portname, port);\n        for (const [portname, port] of this._memrdports())\n            if (!('clock_polarity' in port) && is_enabled(portname, port))\n                do_comb_read(portname, port);\n        for (const [portname, port] of this._memrdports()) {\n            if ('srst_polarity' in port && (is_enabled(portname, port) || !('enable_srst' in port)) && port_active(portname, port))\n                do_srst(portname, port);\n            if ('arst_polarity' in port)\n                do_arst(portname, port);\n        }\n        for (const [portname, port] of this._memrdports())\n            update_last_clk(portname, port);\n        for (const [portname, port] of this._memwrports())\n            update_last_clk(portname, port);\n        return out;\n    },\n    _calcaddr(sig) {\n        if (!sig.isFullyDefined) return -1;\n        return sig.toNumber() - this.get('offset');\n    },\n    * _memrdports() {\n        for (const [num, port] of this.get('rdports').entries())\n            yield [\"rd\" + num, port];\n    },\n    * _memwrports() {\n        for (const [num, port] of this.get('wrports').entries())\n            yield [\"wr\" + num, port];\n    },\n    * _memports() {\n        yield* this._memrdports();\n        yield* this._memwrports();\n    },\n    markup: Box.prototype.markup.concat([{\n            tagName: 'path',\n            className: 'portsplit',\n            selector: 'portsplit'\n        }], Box.prototype.markupZoom),\n    getGateParams() {\n        // hack to get memdata back\n        const params = Box.prototype.getGateParams.apply(this, arguments);\n        params.memdata = this.memdata.toJSON();\n        return params;\n    },\n    _gateParams: Box.prototype._gateParams.concat(['bits', 'abits', 'rdports', 'wrports', 'words', 'offset']),\n    _unsupportedPropChanges: Box.prototype._unsupportedPropChanges.concat(['bits', 'abits', 'rdports', 'wrports', 'words', 'offset']),\n    _operationHelpers: Box.prototype._operationHelpers.concat(['_memrdports', '_memwrports', '_memports', '_calcaddr'])\n});\nexport const MemoryView = BoxView.extend({\n    _autoResizeBox: true,\n    events: {\n        \"click foreignObject.tooltip\": \"stopprop\",\n        \"mousedown foreignObject.tooltip\": \"stopprop\",\n        \"touchstart foreignObject.tooltip\": \"stopprop\", // make sure the input receives focus\n        \"click a.zoom\": \"_displayEditor\"\n    },\n    _displayEditor(evt) {\n        evt.stopPropagation();\n        const model = this.model;\n        const display3vl = model.graph._display3vl;\n        const div = $('<div>', {\n            title: \"Memory contents: \" + model.get('label')\n        }).appendTo('html > body');\n        div.append($(\n            '<div class=\"btn-toolbar\" role=\"toolbar\">' +\n            '<div class=\"btn-group mr-2\" role=\"group\">' +\n            '<button name=\"prev\" type=\"button\" class=\"btn btn-secondary\" title=\"Previous page\"></button>' +\n            '<button name=\"next\" type=\"button\" class=\"btn btn-secondary\" title=\"Next page\"></button>' +\n            '</div>' + \n//            '<div class=\"btn-group mr-2\" role=\"group\">' +\n//            '<button type=\"button\" class=\"btn btn-secondary\" title=\"Load contents\">Load</button>' +\n//            '<button type=\"button\" class=\"btn btn-secondary\" title=\"Save contents\">Save</button>' +\n//            '</div>' + \n            '<div class=\"input-group\">' +\n            help.baseSelectMarkupHTML(display3vl, model.get('bits'), 'hex') +\n            '</div>' +\n            '</div>' +\n            '<table class=\"memeditor\">' +\n            '</table>'));\n        const words = model.get('words');\n        const memdata = model.memdata;\n        const ahex = Math.ceil(model.get('abits')/4);\n        const rows = 8;\n        let columns, address = 0;\n        const get_numbase = () => div.find('select[name=base]').val();\n        const getCell = (addr) => {\n            const r = Math.floor((addr - address) / columns);\n            const c = addr - address - r * columns;\n            return div.find('table tr:nth-child('+(r+1)+') td:nth-child('+(c+2)+') input');\n        }\n        const clearMarkings = (sigs) => {\n            for (const [portname, port] of model._memrdports()) {\n                getCell(model._calcaddr(sigs[portname + 'addr'])).removeClass('isread');\n            }\n            for (const [portname, port] of model._memwrports()) {\n                getCell(model._calcaddr(sigs[portname + 'addr'])).removeClass('iswrite');\n            }\n        }\n        const displayMarkings = (sigs) => {\n            for (const [portname, port] of model._memrdports()) {\n                getCell(model._calcaddr(sigs[portname + 'addr'])).addClass('isread');\n            }\n            for (const [portname, port] of model._memwrports()) {\n                getCell(model._calcaddr(sigs[portname + 'addr'])).addClass('iswrite');\n            }\n        }\n        const updateStuff = () => {\n            const numbase = get_numbase();\n            div.find('button[name=prev]').prop('disabled', address <= 0);\n            div.find('button[name=next]').prop('disabled', address + rows * columns >= words);\n            let row = div.find('table tr:first-child');\n            const memdata = model.memdata;\n            for (let r = 0; r < rows; r++, row = row.next()) {\n                if (address + r * columns >= words) break;\n                const addrs = (address + r * columns).toString(16);\n                let col = row.find('td:first-child');\n                col.text('0'.repeat(ahex - addrs.length) + addrs)\n                col = col.next();\n                for (let c = 0; c < columns; c++, col = col.next()) {\n                    if (address + r * columns + c >= words) break;\n                    col.find('input').val(display3vl.show(numbase, memdata.get(address + r * columns + c)))\n                                     .removeClass('invalid');\n                }\n            }\n            displayMarkings(model.get('inputSignals'));\n        };\n        const redraw = () => {\n            const numbase = get_numbase();\n            const ptrn = display3vl.pattern(numbase);\n            const ds = display3vl.size(numbase, model.get('bits')); \n            columns = Math.min(words, 16, Math.ceil(32/ds));\n            address = Math.max(0, Math.min(words - rows * columns, address));\n            const table = div.find('table');\n            table.empty();\n            for (let r = 0; r < rows; r++) {\n                if (address + r * columns >= words) break;\n                const row = $('<tr>');\n                $('<td>').appendTo(row);\n                for (let c = 0; c < columns; c++) {\n                    if (address + r * columns + c >= words) break;\n                    const col = $('<td>');\n                    $('<input type=\"text\">')\n                        .attr('size', ds)\n                        .attr('maxlength', ds)\n                        .attr('pattern', ptrn)\n                        .appendTo(col);\n                    col.appendTo(row);\n                }\n                row.appendTo(table);\n            }\n            updateStuff();\n        };\n        redraw();\n        div.find(\"select[name=base]\").on('change', redraw);\n        div.find(\"button[name=prev]\").on('click', () => {\n            clearMarkings(model.get('inputSignals'));\n            address = Math.max(0, address - rows * columns);\n            updateStuff();\n        });\n        div.find(\"button[name=next]\").on('click', () => {\n            clearMarkings(model.get('inputSignals'));\n            address = Math.min(words - rows * columns, address + rows * columns);\n            updateStuff();\n        });\n        div.on(\"change\", \"input\", (evt) => {\n            const numbase = get_numbase();\n            const target = $(evt.target);\n            const c = target.closest('td').index() - 1;\n            const r = target.closest('tr').index();\n            const addr = address + r * columns + c;\n            const bits = model.get('bits');\n            if (display3vl.validate(numbase, evt.target.value, bits)) {\n                const val = display3vl.read(numbase, evt.target.value, bits);\n                memdata.set(addr, val);\n                model.trigger('manualMemChange', model, addr, val);\n                target.removeClass('invalid');\n            } else {\n                target.addClass('invalid');\n            }\n        });\n        const mem_change_cb = (addr, data) => {\n            if (addr < address || addr > address + rows * columns) return;\n            const numbase = get_numbase();\n            const z = getCell(addr)\n                .val(display3vl.show(numbase, memdata.get(addr)))\n                .removeClass('invalid')\n                .removeClass('flash');\n            setTimeout(() => { z.addClass('flash') }, 10);\n        };\n        const input_change_cb = (gate, sigs) => {\n            clearMarkings(model.previous('inputSignals'));\n            displayMarkings(sigs);\n        };\n        model.on(\"memChange\", mem_change_cb);\n        model.on(\"change:inputSignals\", input_change_cb);\n        this.paper.trigger('open:memorycontent', div, () => {\n            div.remove();\n            model.off(\"memChange\", mem_change_cb);\n            model.off(\"change:inputSignals\", input_change_cb);\n        });\n        return false;\n    }\n});\n\n","\"use strict\";\n\nimport $ from 'jquery';\nimport _ from 'lodash';\nimport * as joint from '@joint/core';\nimport { DirectedGraph } from '@joint/layout-directed-graph';\nimport { Box, BoxView } from './base.mjs';\nimport { Vector3vl } from '3vl';\nimport dagre from 'dagre';\nimport graphlib from 'graphlib';\n\nexport const FSM = Box.define('FSM', {\n    /* default properties */\n    bits: { in: 1, out: 1},\n    polarity: { clock: true },\n    init_state: 0,\n    states: 1,\n    trans_table: [],\n\n    size: { width: 80, height: 3*16+8 },\n    ports: {\n        groups: {\n            'in': {\n                position: Box.prototype._getStackedPosition({ side: 'left' })\n            },\n            'out': {\n                position: Box.prototype._getStackedPosition({ side: 'right' })\n            }\n        }\n    }\n}, {\n    initialize() {\n        const bits = this.get('bits');\n        const polarity = this.get('polarity');\n\n        const init_state = this.get('init_state');\n        const states = this.get('states');\n        const trans_table = this.get('trans_table');\n\n        this.get('ports').items = [\n            { id: 'in', group: 'in', dir: 'in', bits: bits.in, labelled: true },\n            { id: 'clk', group: 'in', dir: 'in', bits: 1, polarity: polarity.clock, decor: Box.prototype.decorClock, labelled: true },\n            { id: 'arst', group: 'in', dir: 'in', bits: 1, polarity: polarity.arst, labelled: true },\n            { id: 'out', group: 'out', dir: 'out', bits: bits.out, labelled: true }\n        ];\n\n        Box.prototype.initialize.apply(this, arguments);\n\n        const current_state = this.get('current_state');\n\n        this.fsmgraph = new joint.dia.Graph;\n        const statenodes = [];\n        for (let n = 0; n < states; n++) {\n            const node = new joint.shapes.standard.Circle({stateNo: n, id: 'state' + n, isInit: n == init_state});\n            node.attr('label/text', String(n));\n            node.resize(50,50);\n            if (n == init_state)\n                node.attr('body/strokeWidth', 3)\n            if (n == current_state)\n                node.attr('body/class', 'current_state');\n            node.addTo(this.fsmgraph);\n            statenodes.push(node);\n        }\n        for (const [stateIn, trs] of this.transitions) {\n            for (const tr of trs) {\n                const trans = new joint.shapes.standard.Link({\n                    id: tr.id, \n                    ctrlIn: tr.ctrlIn,\n                    ctrlOut: tr.ctrlOut\n                });\n                trans.appendLabel({\n                    attrs: {\n                        text: {\n                            text: trans.get('ctrlIn').toBin() + '/' + trans.get('ctrlOut').toBin()\n                        }\n                    }\n                });\n                trans.source({ id: 'state' + stateIn });\n                trans.target({ id: 'state' + tr.stateOut });\n                trans.addTo(this.fsmgraph);\n            }\n        }\n\n        this.listenTo(this, 'change:current_state', (model, state) => {\n            const pstate = model.previous('current_state');\n            this.fsmgraph.getCell('state' + pstate).removeAttr('body/class');\n            this.fsmgraph.getCell('state' + state).attr('body/class', 'current_state');\n        });\n        this.listenTo(this, 'change:next_trans', (model, id) => {\n            const pid = model.previous('next_trans');\n            if (pid) {\n                const cell = this.fsmgraph.getCell(pid);\n                cell.removeAttr('line/class');\n                cell.removeAttr('line/targetMarker/class');\n            }\n            if (id) {\n                this.fsmgraph.getCell(id).attr({\n                    line: {\n                        class: 'next_trans',\n                        targetMarker: {\n                            class: 'next_trans'\n                        }\n                    }\n                });\n            }\n        });\n    },\n    prepare() {\n        const bits = this.get('bits');\n        this.transitions = new Map();\n        var id = 0;\n        for (const tr of this.get('trans_table')) {\n            if (!this.transitions.has(tr.state_in))\n                this.transitions.set(tr.state_in, []);\n            this.transitions.get(tr.state_in).push({\n                id: 'tr'+id,\n                stateOut: tr.state_out,\n                ctrlIn: Vector3vl.fromBin(tr.ctrl_in, bits.in),\n                ctrlOut: Vector3vl.fromBin(tr.ctrl_out, bits.out)\n            });\n            id++;\n        };\n        var current_state = this.get('current_state');\n        if (current_state === undefined) {\n            current_state = this.get('init_state');\n            this.set('current_state', current_state);\n        }\n        this.last_clk = 0;\n    },\n    operation(data) {\n        const bits = this.get('bits');\n        const polarity = this.get('polarity');\n        const next_trans = () => {\n            const links = this.transitions.get(this.get('current_state')) || [];\n            for (const trans of links) {\n                const ctrlIn = trans.ctrlIn;\n                const xmask = ctrlIn.xmask();\n                if (data.in.or(xmask).eq(ctrlIn.or(xmask)))\n                    return trans;\n            }\n        };\n        const next_output = () => {\n            const links = this.transitions.get(this.get('current_state')) || [];\n            const ixmask = data.in.xmask();\n            const results = [];\n            for (const trans of links) {\n                const ctrlIn = trans.ctrlIn;\n                const xmask = ctrlIn.xmask().or(ixmask);\n                if (data.in.or(xmask).eq(ctrlIn.or(xmask)))\n                    results.push(trans.ctrlOut);\n            }\n            const xes = Vector3vl.xes(bits.out);\n            if (results.length == 0) return xes;\n            while (results.length > 1) {\n                const other = results.pop();\n                const eqs = results[0].xnor(other).or(xes);\n                results[0] = results[0].and(eqs).or(xes.and(eqs.xmask()));\n            };\n            return results[0];\n        };\n        const pol = what => polarity[what] ? 1 : -1;\n        if (data.arst.get(0) == pol('arst')) {\n            this.set('current_state', this.get('init_state'));\n        } else {\n            const last_clk = this.last_clk;\n            if (data.clk.get(0) == pol('clock') && last_clk == -pol('clock')) {\n                const trans = next_trans();\n                this.set('current_state',\n                    trans ? trans.stateOut : this.get('init_state'));\n            }\n        }\n        this.last_clk = data.clk.get(0);\n        const trans = next_trans();\n        if (!trans) {\n            this.set('next_trans', undefined);\n        } else {\n            this.set('next_trans', trans.id);\n        }\n        return { out: next_output() };\n    },\n    markup: Box.prototype.markup.concat(Box.prototype.markupZoom),\n    _gateParams: Box.prototype._gateParams.concat(['bits', 'polarity', 'states', 'init_state', 'trans_table']),\n    _unsupportedPropChanges: Box.prototype._unsupportedPropChanges.concat(['bits', 'polarity', 'states', 'init_state', 'trans_table']),\n    _presentationParams: Box.prototype._presentationParams.concat(['current_state', 'next_trans'])\n});\n\nexport const FSMView = BoxView.extend({\n    _autoResizeBox: true,\n    events: {\n        \"click foreignObject.tooltip\": \"stopprop\",\n        \"mousedown foreignObject.tooltip\": \"stopprop\",\n        \"touchstart foreignObject.tooltip\": \"stopprop\", // make sure the input receives focus\n        \"click a.zoom\": \"_displayEditor\"\n    },\n    _displayEditor(evt) {\n        evt.stopPropagation();\n        const div = $('<div>', {\n            title: \"FSM: \" + this.model.get('label')\n        }).appendTo('html > body');\n        const pdiv = $('<div>').appendTo(div);\n        const graph = this.model.fsmgraph;\n        const paper = new joint.dia.Paper({\n            el: pdiv,\n            model: graph\n        });\n        // to visualize the cells\n        graph.resetCells(graph.getCells());\n        // lazy layout\n        if (!graph.get('laid_out')) {\n            DirectedGraph.layout(graph, {\n                dagre: dagre,\n                graphlib: graphlib\n            });\n            graph.set('laid_out', true);\n        }\n        // auto-resizing\n        paper.listenTo(graph, 'change:position', (elem) => {\n            paper.fitToContent({ padding: 30, allowNewOrigin: 'any' });\n        });\n        paper.fitToContent({ padding: 30, allowNewOrigin: 'any' });\n        this.paper.trigger('open:fsm', div, () => {\n            paper.remove();\n            div.remove();\n        });\n        return false;\n    }\n});\n\n","import { IO, IOView, NumBase } from './io.mjs';\nimport { BoxView } from './base.mjs';\n\nconst highColor = '#03c03c';\nconst lowColor = '#3c3c3c';\n\n/*\n * This is a standard 7-segment display element.\n * It is designed to take an 8-bit number as an input.\n *\n * The most significant bit determines the decimal point state (dp).\n * The following bits determine states of respectively: a,b,c,d,e,f,g\n * segments of the display. (g is determined by the least significant bit).\n *\n * The placement of single segments of the display can be checked\n * on the wikipedia page here:\n * https://en.wikipedia.org/wiki/Seven-segment_display#/media/File:7_Segment_Display_with_Labeled_Segments.svg\n */\nexport const Display7 = IO.define('Display7',\n{\n  bits: 8,\n  size: { width: 76.5, height: 110 },\n  attrs: {\n    LEDs: {\n      fill: lowColor,\n      transform: 'translate(1,1),scale(6)'\n    },\n    a: {\n      points: '1, 1  2, 0  8, 0  9, 1  8, 2  2, 2'\n    },\n    b: {\n      points: '9, 1 10, 2 10, 8  9, 9  8, 8  8, 2'\n    },\n    c: {\n      points: '9, 9 10,10 10,16  9,17  8,16  8,10'\n    },\n    d: {\n      points: '9,17  8,18  2,18  1,17  2,16  8,16'\n    },\n    e: {\n      points: '1,17  0,16  0,10  1, 9  2,10  2,16'\n    },\n    f: {\n      points: '1, 9  0, 8  0, 2  1, 1  2, 2  2, 8'\n    },\n    g: {\n      points: '1, 9  2, 8  8, 8  9, 9  8,10  2,10'\n    },\n    dp: {\n      cx: '11.3',\n      cy: '16.9',\n      r: '1.1'\n    },\n    body: {\n      height: 'calc(h)',\n      width: 'calc(w)',\n      stroke: '#222222',\n      fill: '#333333',\n    }\n  }\n}, {\n  isOutput: true,\n  _portDirection: 'in',\n  bits: 8,\n\n  getOutput() {\n    return this.get('inputSignals').in;\n  },\n  markupBus: NumBase.prototype.markup.concat([\n    {\n      tagName: 'rect',\n      selector: 'display'\n    },\n    {\n      tagName: 'polygon',\n      selector: 'a',\n      groupSelector: 'LEDs'\n    }, {\n      tagName: 'polygon',\n      selector: 'b',\n      groupSelector: 'LEDs'\n    }, {\n      tagName: 'polygon',\n      selector: 'c',\n      groupSelector: 'LEDs'\n    }, {\n      tagName: 'polygon',\n      selector: 'd',\n      groupSelector: 'LEDs'\n    }, {\n      tagName: 'polygon',\n      selector: 'e',\n      groupSelector: 'LEDs'\n    }, {\n      tagName: 'polygon',\n      selector: 'f',\n      groupSelector: 'LEDs'\n    }, {\n      tagName: 'polygon',\n      selector: 'g',\n      groupSelector: 'LEDs'\n    }, {\n      tagName: 'circle',\n      selector: 'dp',\n      groupSelector: 'LEDs'\n    }]),\n});\n\nexport const Display7View = IOView.extend({\n  _autoResizeBox: false,\n\n  confirmUpdate(flags) {\n    BoxView.prototype.confirmUpdate.apply(this, arguments);\n    this._updateDisplay();\n  },\n  _updateDisplay() {\n    const inputSignal = this.model.getOutput();\n    const newAttrs = {\n      dp: { fill: inputSignal.get(7) === 1 ? highColor : lowColor },\n      a: { fill: inputSignal.get(6) === 1 ? highColor : lowColor },\n      b: { fill: inputSignal.get(5) === 1 ? highColor : lowColor },\n      c: { fill: inputSignal.get(4) === 1 ? highColor : lowColor },\n      d: { fill: inputSignal.get(3) === 1 ? highColor : lowColor },\n      e: { fill: inputSignal.get(2) === 1 ? highColor : lowColor },\n      f: { fill: inputSignal.get(1) === 1 ? highColor : lowColor },\n      g: { fill: inputSignal.get(0) === 1 ? highColor : lowColor },\n    };\n    this._applyAttrs(newAttrs);\n  },\n});\n","\nimport * as cells from '../cells.mjs';\nimport FastPriorityQueue from 'fastpriorityqueue';\nimport { Vector3vl } from '3vl';\n\nconst specialGates = new Set(['Subcircuit', 'Input', 'Output', 'Button', 'Lamp', 'NumEntry', 'NumDisplay']);\n\nclass Link {\n    constructor(source, target) {\n        this.source = source;\n        this.target = target;\n    }\n}\n\nclass Gate {\n    constructor(id, graph, gateParams, ports, inputSignals, outputSignals) {\n        this.id = id;\n        this.graph = graph;\n        this.special = specialGates.has(gateParams.type);\n        this.isSubcircuit = gateParams.type == 'Subcircuit';\n        this.isOutput = gateParams.type == 'Output';\n        const cell = cells[gateParams.type].prototype;\n        this.operation = cell.operation;\n        for (const helper of cell._operationHelpers)\n            this[helper] = cell[helper];\n        this.links = new Set();\n        this._links_to = Object.create(null);\n        this._params = gateParams;\n        this._params.inputSignals = Object.create(null);\n        this._params.outputSignals = Object.create(null);\n        this._presentationParams = cell._presentationParams;\n        this._presentationParamChanged = Object.create(null);\n        this._monitors = Object.create(null);\n        this._ports = Object.create(null);\n        for (const port of ports) {\n            this._ports[port.id] = port;\n            this._monitors[port.id] = new Set();\n            if (port.dir == \"in\")\n                this._params.inputSignals[port.id] = Vector3vl.fromClonable(inputSignals[port.id]);\n            if (port.dir == \"out\") {\n                this._params.outputSignals[port.id] = Vector3vl.fromClonable(outputSignals[port.id]);\n                this._links_to[port.id] = new Set();\n            }\n        }\n        cell.prepare.call(this);\n    }\n    get(name) {\n        return this._params[name];\n    }\n    set(name, value) {\n        this._params[name] = value;\n        if (this._presentationParams.includes(name)) {\n            worker._markPresentationParam(this, name);\n        }\n    }\n    addLinkTo(port, target) {\n        this._links_to[port].add(target);\n    }\n    removeLinkTo(port, target) {\n        this._links_to[port].delete(target);\n    }\n    addLink(linkId) {\n        this.links.add(linkId);\n    }\n    removeLink(linkId) {\n        this.links.delete(linkId);\n    }\n    targets(port) {\n        return this._links_to[port];\n    }\n    getPort(port) {\n        return this._ports[port];\n    }\n    getPorts() {\n        return Object.values(this._ports);\n    }\n    trigger(event, ...args) {\n        postMessage({ type: 'gateTrigger', args: [this.graph.id, this.id, event, args] });\n    }\n    monitor(port, monitorId) {\n        this._monitors[port].add(monitorId);\n    }\n    unmonitor(port, monitorId) {\n        this._monitors[port].delete(Number(monitorId));\n    }\n    getMonitors(port) {\n        return this._monitors[port];\n    }\n}\n\nclass Graph {\n    constructor(id) {\n        this.id = id;\n        this._gates = {};\n        this._links = {};\n        this._observed = false;\n        this._subcircuit = null;\n    }\n    addLink(linkId, source, target) {\n        this._links[linkId] = new Link(source, target);\n        this._gates[source.id].addLinkTo(source.port, target);\n        this._gates[source.id].addLink(linkId);\n        this._gates[target.id].addLink(linkId);\n    }\n    addGate(gateId, gateParams, ports, inputSignals, outputSignals) {\n        this._gates[gateId] = new Gate(gateId, this, gateParams, ports, inputSignals, outputSignals);\n    }\n    removeLink(linkId) {\n        const link = this._links[linkId];\n        this._gates[link.source.id].removeLinkTo(link.source.port, link.target);\n        this._gates[link.source.id].removeLink(linkId);\n        this._gates[link.target.id].removeLink(linkId);\n        delete this._links[linkId];\n    }\n    removeGate(gateId) {\n        for (const linkId of this._gates[gateId].links)\n            this.removeLink(linkId);\n        this._gates[gateId].graph = null;\n        delete this._gates[gateId];\n    }\n    getGate(gateId) {\n        return this._gates[gateId];\n    }\n    getLink(linkId) {\n        return this._links[linkId];\n    }\n    getGates() {\n        return Object.values(this._gates);\n    }\n    observe() {\n        this._observed = true;\n    }\n    unobserve() {\n        this._observed = false;\n    }\n    get observed() {\n        return this._observed;\n    }\n    setSubcircuit(gate) {\n        this._subcircuit = gate;\n    }\n    get subcircuit() {\n        return this._subcircuit;\n    }\n}\n\nclass WorkerEngineWorker {\n    constructor() {\n        this._interval = 10;\n        this._graphs = Object.create(null);\n        this._monitors = Object.create(null);\n        this._monitorChecks = Object.create(null);\n        this._alarms = Object.create(null);\n        this._alarmQueue = new Map();\n        this._queue = new Map();\n        this._pq = new FastPriorityQueue();\n        this._toUpdate = new Map();\n        this._toUpdateParam = new Map();\n        this._tick = 0;\n        this._sender = setInterval(() => {\n            this._sendUpdates();\n        }, 25);\n        this._updater = null;\n    }\n    interval(ms) {\n        this._interval = ms;\n    }\n    updateGates(reqid, sendUpdates) {\n        const count = this._updateGates();\n        if (sendUpdates) this._sendUpdates();\n        this._postMonitors();\n        this._sendAck(reqid, count);\n    }\n    _updateGates() {\n        if (this._pq.peek() == this._tick) return this._updateGatesNext();\n        else {\n            const k = this._tick | 0;\n            this._tick = (k + 1) | 0;\n            return 0;\n        }\n    }\n    updateGatesNext(reqid, sendUpdates) {\n        const count = this._updateGatesNext();\n        if (sendUpdates) this._sendUpdates();\n        this._postMonitors();\n        this._sendAck(reqid, count);\n    }\n    _updateGatesNext() {\n        const k = this._pq.poll() | 0;\n        console.assert(k >= this._tick);\n        this._tick = k;\n        const q = this._queue.get(k);\n        let count = 0;\n        while (q.size) {\n            const [gate, args] = q.entries().next().value;\n            q.delete(gate);\n            if (gate.special) continue;\n            const graph = gate.graph;\n            if (!graph) continue;\n            const newOutputs = gate.operation(args);\n            if ('_clock_hack' in newOutputs) {\n                delete newOutputs['_clock_hack'];\n                this._enqueue(gate);\n            }\n            this._setGateOutputSignals(gate, newOutputs);\n            count++;\n        }\n        this._queue.delete(k);\n        this._tick = (k + 1) | 0;\n        return count;\n    }\n    ping(reqid, sendUpdates) {\n        if (sendUpdates) this._sendUpdates();\n        this._sendAck(reqid);\n    }\n    start() {\n        this._stop();\n        this._updater = setInterval(() => {\n            this._updateGates();\n            this._postMonitors();\n        }, this._interval);\n    }\n    startFast() {\n        this._stop();\n        this._updater = setInterval(() => {\n            const startTime = Date.now();\n            while (Date.now() - startTime < 10 && this._hasPendingEvents() && this._updater) {\n                this._updateGatesNext();\n                this._postMonitors();\n            }\n        }, 10);\n    }\n    stop(reqid, sendUpdates) {\n        this._stop();\n        if (sendUpdates) this._sendUpdates();\n        this._sendAck(reqid);\n    }\n    _stop() {\n        if (this._updater) {\n            clearInterval(this._updater);\n            this._updater = null;\n        }\n    }\n    addGraph(graphId) {\n        console.assert(!(graphId in this._graphs));\n        this._graphs[graphId] = new Graph(graphId);\n    }\n    addLink(graphId, linkId, source, target) {\n        const graph = this._graphs[graphId];\n        graph.addLink(linkId, source, target);\n        const sourceGate = graph.getGate(source.id);\n        const targetGate = graph.getGate(target.id);\n        const sig = sourceGate.get('outputSignals')[source.port];\n        this._setGateInputSignal(targetGate, target.port, sig);\n    }\n    addGate(graphId, gateId, gateParams, ports, inputSignals, outputSignals) {\n        const graph = this._graphs[graphId];\n        graph.addGate(gateId, gateParams, ports, inputSignals, outputSignals);\n        this._enqueue(graph.getGate(gateId));\n    }\n    addSubcircuit(graphId, gateId, subgraphId, IOmap) {\n        const graph = this._graphs[graphId];\n        const gate = graph.getGate(gateId);\n        const subgraph = this._graphs[subgraphId];\n        gate.set('subgraph', subgraph);\n        gate.set('circuitIOmap', IOmap);\n        subgraph.setSubcircuit(gate);\n        for (const [port, ioId] of Object.entries(IOmap)) {\n            const io = subgraph.getGate(ioId);\n            if (gate.getPort(port).dir == 'in') {\n                this._setGateOutputSignal(io, 'out', gate.get('inputSignals')[port]);\n            }\n            if (gate.getPort(port).dir == 'out') {\n                this._setGateOutputSignal(gate, port, io.get('inputSignals').in);\n            }\n        }\n    }\n    removeLink(graphId, linkId) {\n        const graph = this._graphs[graphId];\n        const link = graph.getLink(linkId);\n        graph.removeLink(linkId);\n        const targetGate = graph.getGate(link.target.id);\n        const sig = Vector3vl.xes(targetGate.getPort(link.target.port).bits);\n        this._setGateInputSignal(targetGate, link.target.port, sig);\n    }\n    removeGate(graphId, gateId) {\n        this._graphs[graphId].removeGate(gateId);\n    }\n    observeGraph(graphId) {\n        const graph = this._graphs[graphId];\n        graph.observe();\n        for (const gate of graph.getGates())\n            for (const port of gate.getPorts())\n                if (port.dir == 'out')\n                    this._markUpdate(gate, port.id);\n    }\n    unobserveGraph(graphId) {\n        this._graphs[graphId].unobserve();\n    }\n    changeInput(graphId, gateId, sig) {\n        const gate = this._graphs[graphId].getGate(gateId);\n        this._setGateOutputSignals(gate, { out: Vector3vl.fromClonable(sig) });\n    }\n    changeParam(graphId, gateId, paramName, val) {\n        const gate = this._graphs[graphId].getGate(gateId);\n        gate.set(paramName, val);\n    }\n    manualMemChange(graphId, gateId, addr, data) {\n        const gate = this._graphs[graphId].getGate(gateId);\n        gate.memdata.set(addr, Vector3vl.fromClonable(data));\n        this._enqueue(gate);\n    }\n    monitor(graphId, gateId, port, monitorId, {triggerValues, stopOnTrigger, oneShot, synchronous }) {\n        if (triggerValues != undefined)\n            for (const k of triggerValues.keys())\n                triggerValues[k] = Vector3vl.fromClonable(triggerValues[k]);\n        const gate = this._graphs[graphId].getGate(gateId);\n        this._monitors[monitorId] = { gate, port, triggerValues, stopOnTrigger, oneShot, synchronous };\n        gate.monitor(port, monitorId);\n        if (triggerValues == undefined)\n            postMessage({ type: 'monitorValue', args: [monitorId, this._tick, gate.get('outputSignals')[port]] });\n    }\n    unmonitor(monitorId) {\n        const monitor = this._monitors[monitorId];\n        if (monitor == undefined) return;\n        monitor.gate.unmonitor(monitor.port, monitorId);\n        delete this._monitors[monitorId];\n        delete this._monitorChecks[monitorId];\n    }\n    alarm(tick, alarmId, {stopOnAlarm, synchronous}) {\n        if (tick <= this._tick) return;\n        this._alarms[alarmId] = { tick, stopOnAlarm, synchronous };\n        if (!this._alarmQueue.has(tick))\n            this._alarmQueue.set(tick, new Set());\n        this._alarmQueue.get(tick).add(alarmId);\n        this._pq.add(tick-1);\n        if (!this._queue.has(tick-1))\n            this._queue.set(tick-1, new Map());\n    }\n    unalarm(alarmId) {\n        const alarm = this._alarms[alarmId];\n        if (alarm == undefined) return;\n        const tick = alarm.tick;\n        this._alarmQueue.get(tick).delete(alarmId);\n        if (this._alarmQueue.get(tick).size == 0)\n            this._alarmQueue.delete(tick);\n        delete this._alarms[alarmId];\n    }\n    _enqueue(gate) {\n        const k = (this._tick + gate.get('propagation')) | 0;\n        const sq = (() => {\n            const q = this._queue.get(k);\n            if (q !== undefined) return q;\n            const q1 = new Map();\n            this._queue.set(k, q1);\n            this._pq.add(k);\n            return q1;\n        })();\n        sq.set(gate, Object.assign({}, gate.get('inputSignals')));\n    }\n    _postMonitors() {\n        for (const [monitorId, sig] of Object.entries(this._monitorChecks)) {\n            const {triggerValues, stopOnTrigger, oneShot, synchronous} = this._monitors[monitorId];\n            let triggered = true;\n            if (triggerValues)\n                triggered = triggerValues.some((triggerValue) => sig.eq(triggerValue));\n            if (triggered) {\n                if (oneShot) this.unmonitor(monitorId);\n                if (synchronous) this._sendUpdates();\n                postMessage({ type: 'monitorValue', args: [monitorId, this._tick, sig, stopOnTrigger, oneShot] });\n                if (stopOnTrigger) this._stop();\n            }\n        }\n        this._monitorChecks = Object.create(null);\n        if (this._alarmQueue.get(this._tick)) {\n            for (const alarmId of this._alarmQueue.get(this._tick)) {\n                const { stopOnAlarm, synchronous } = this._alarms[alarmId];\n                if (synchronous) this._sendUpdates();\n                delete this._alarms[alarmId];\n                postMessage({ type: 'alarmReached', args: [alarmId, this._tick, stopOnAlarm] });\n                if (stopOnAlarm) this._stop();\n            }\n            this._alarmQueue.delete(this._tick);\n        }\n    }\n    _setGateOutputSignals(gate, newOutputs) {\n        for (const [port, sig] of Object.entries(newOutputs)) {\n            this._setGateOutputSignal(gate, port, sig);\n        }\n    }\n    _setGateOutputSignal(gate, port, sig) {\n        const outputs = gate.get('outputSignals');\n        const oldOutput = outputs[port];\n        if (sig.eq(oldOutput)) return;\n        outputs[port] = sig;\n        this._markUpdate(gate, port);\n        for (const target of gate.targets(port)) {\n            const targetGate = gate.graph.getGate(target.id);\n            this._setGateInputSignal(targetGate, target.port, sig);\n        }\n        const monitors = gate.getMonitors(port);\n        for (const monitorId of monitors)\n            this._monitorChecks[monitorId] = sig;\n    }\n    _setGateInputSignal(targetGate, port, sig) {\n        const inputs = targetGate.get('inputSignals');\n        const oldInput = inputs[port];\n        if (sig.eq(oldInput)) return;\n        inputs[port] = sig;\n        if (targetGate.isSubcircuit) {\n            const subgraph = targetGate.get('subgraph');\n            if (!subgraph) return;\n            const iomap = targetGate.get('circuitIOmap');\n            const gate = subgraph.getGate(iomap[port]);\n            if (!gate) return;\n            this._setGateOutputSignals(gate, { out: sig });\n        } else if (targetGate.isOutput) {\n            const subcir = targetGate.graph.subcircuit;\n            if (!subcir) return;\n            const subcirPort = targetGate.get('net');\n            this._setGateOutputSignal(subcir, subcirPort, sig);\n        } else {\n            this._enqueue(targetGate);\n        }\n    }\n    _markUpdate(gate, port) {\n        if (!gate.graph.observed) return;\n        const s = (() => {\n            const v = this._toUpdate.get(gate);\n            if (v !== undefined) return v;\n            const r = new Set();\n            this._toUpdate.set(gate, r);\n            return r;\n        })();\n        s.add(port);\n    }\n    _markPresentationParam(gate, param) {\n        if (!gate.graph.observed) return;\n        const s = (() => {\n            const v = this._toUpdateParam.get(gate);\n            if (v !== undefined) return v;\n            const r = new Set();\n            this._toUpdateParam.set(gate, r);\n            return r;\n        })();\n        s.add(param);\n    }\n    _sendUpdates() {\n        const updates = [];\n        for (const [gate, ports] of this._toUpdate) {\n            const outputSignals = gate.get('outputSignals');\n            const outputs = {};\n            for (const port of ports)\n                outputs[port] = outputSignals[port];\n            updates.push([gate.graph.id, gate.id, outputs]);\n        }\n        this._toUpdate = new Map();\n        const pendingEvents = this._hasPendingEvents();\n        postMessage({ type: 'update', args: [this._tick, pendingEvents, updates] });\n        if (this._toUpdateParam.size > 0) {\n            for (const [gate, params] of this._toUpdateParam) {\n                for (const param of params)\n                    postMessage({ type: 'gateSet', args: [gate.graph.id, gate.id, param, gate.get(param) ] });\n            }\n            this._toUpdateParam = new Map();\n        }\n    }\n    _sendAck(reqid, response) {\n        postMessage({ type: 'ack', args: [reqid, response] });\n    }\n    _hasPendingEvents() {\n        return this._queue.size > 0;\n    }\n};\n\nconst worker = new WorkerEngineWorker();\n\nself.onmessage = (e) => {\n    const msg = e.data;\n    if ('arg' in msg)\n        worker[msg.type](msg.arg);\n    else if ('args' in msg)\n        worker[msg.type].apply(worker, msg.args);\n    else\n        worker[msg.type]();\n}\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [268], () => (__webpack_require__(5821)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and chunks that the entrypoint depends on\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".main.js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t821: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = this[\"webpackChunkdigitaljs\"] = this[\"webpackChunkdigitaljs\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["root","factory","exports","module","define","amd","this","deferred","next","circleArrowhead","tagName","attributes","CircleSourceArrowhead","extend","CircleTargetArrowhead","DoublyButton","update","relatedView","isShortWire","options","distance","distanceShort","secondary","hide","distanceLong","prototype","apply","arguments","RemoveButton","name","children","MonitorButton","selector","action","evt","notify","portGroupAttrs","wire","stroke","x1","y1","x2","undefined","y2","port","magnet","r","fill","strokeWidth","strokeOpacity","bits","ref","fontSize","iolabel","textVerticalAnchor","decor","Gate","propagation","label","size","width","height","inputSignals","outputSignals","attrs","body","refX","refDy","textAnchor","ports","groups","position","refDx","refY","z","operation","initialize","get","items","_preprocessPorts","prepare","bindAttrToProp","_unsupportedPropChanges","length","on","map","prop","join","__","___","opt","init","changed","Object","keys","forEach","attr","set","previous","console","warn","_","val","_changeOutputSignals","sigs","graph","getConnectedLinks","outbound","groupBy","wires","value","_setInput","sig","signals","_clearInput","getPort","Vector3vl","xes","_resetPortsSignals","text","_getBitsText","labelled","portlabel","id","polarity","assert","group","d","_setPortsBits","portsBits","portsReset","portid","find","push","filter","_changeSource","inbound","_changeTarget","_resetPortValue","in","out","dir","_removePortsSignals","addPort","addPorts","removePort","removePorts","_getStackedPosition","portsArgs","elBBox","side","step","offset","x","topLeft","topRight","y","bottomRight","portArgs","index","idxOffset","getLayoutSize","setLayoutPosition","portMarkup","className","markup","getGateParams","layout","_gateParams","concat","_gateLayoutParams","_operationHelpers","_presentationParams","GateView","signal","high","low","def","undef","presentationAttributes","addPresentationAttributes","stopprop","stopPropagation","confirmUpdate","flags","hasFlag","_updatePortSignals","model","isDefined","isHigh","isLow","_applyPortAttrs","_applyAttrs","node","selectors","setNodeAttributes","_portElementsCache","portSelectors","_updatePorts","Wire","line","class","targetMarker","wrapper","warning","has","onAdd","_was_added","remove","tar","target","getCell","_propagateSignal","getTargetElement","_changeSignal","src","source","getSourceElement","_checkConnection","hasChanged","preTar","preTarget","silent","getWireParams","connector","from","to","vertices","getWirePath","hier","sc","reverse","WireView","initFlag","longWireLength","bus","single","none","_wireToolsView","window","tools","focusOpacity","prevModels","_updateSignal","_updateBits","_updateWarning","getConnectionLength","onRemove","_removeTooltip","mouseenter","addTools","_addTooltip","clientX","clientY","mouseleave","removeTools","pos","wire_hover","css","appendTo","document","_generateTextForTooltip","listenTo","stopListening","display3vl","_display3vl","hovertext","show","html","onEndModelChange","endType","endModel","Box","refWidth","refHeight","tooltip","tooltipMinWidth","trigger","markupZoom","namespaceURI","textContent","style","cursor","decorClock","l","BoxView","_autoResizeBox","render","_calculateBoxWidth","leftlabels","Array","el","querySelectorAll","rightlabels","leftwidth","Math","max","getBBox","rightwidth","fixup","NumBase","numbase","usableDisplays","numbaseType","includes","markupTooltip","NumBaseView","events","_changeNumbase","testtext","createElementNS","$el","_makeNumBaseSelector","_updateNumBaseSelector","$","empty","base","IO","net","mode","ioname","fontWeight","_portDirection","b","_checkMode","withinSubcircuit","markupInSubcircuit","markupSingle","markupBus","subcir","portsBitsSubcir","IOView","getAttribute","call","Input","btnface","valinput","xAlignment","yAlignment","isInput","zeros","setInput","toggleInput","not","Error","type","InputView","button","_updateView","_updateButton","_updateNumEntry","removeClass","_onButton","_onNumEntry","validate","read","addClass","ButtonView","NumEntry","NumEntryView","Output","led","refR","isOutput","getOutput","OutputView","lamp","_updateLamp","_updateNumDisplay","Lamp","LampView","NumDisplay","NumDisplayView","Constant","constant","fromBin","ConstantView","constantCache","_showText","Clock","zero","_clock_hack","min","ClockView","args","updatePropagation","_changePropagation","valid","String","Number","toggleClass","and_path","or_path","buf_path","xor_arc_path_markup","neg_markup","gateMarkup","GateSVG","dx","Gate11","GateX1","inputs","gate","xor_arc","neg_bubble","i","scaling","param","data","ret","in1","binoperation","finoperation","GateReduce","Repeater","RepeaterView","Not","NotView","Or","in2","or","OrView","And","and","AndView","Nor","NorView","Nand","NandView","Xor","xor","XorView","Xnor","XnorView","OrReduce","reduceOr","OrReduceView","NorReduce","reduceNor","NorReduceView","AndReduce","reduceAnd","AndReduceView","NandReduce","reduceNand","NandReduceView","XorReduce","reduceXor","XorReduceView","XnorReduce","reduceXnor","XnorReduceView","isSafeInteger","v","MAX_SAFE_INTEGER","Arith","refCx","refCy","oper","Arith11","signed","isFullyDefined","fromNumber","arithop","toBigInt","Arith21","sgn","shiftHelp","am","bits_in","bits_out","sgn_in","sgn_out","fillx","signbit","ext","make","my_in","slice","Shift","toNumber","shiftdir","BaseCompare","Compare","fromBool","arithcomp","EqCompare","msb","bincomp","Negation","NegationView","UnaryPlus","UnaryPlusView","Addition","j","AdditionView","Subtraction","SubtractionView","Multiplication","MultiplicationView","Division","DivisionView","Modulo","ModuloView","Power","PowerView","ShiftLeft","ShiftLeftView","ShiftRight","ShiftRightView","Lt","LtView","Le","LeView","Gt","GtView","Ge","GeView","Eq","xnor","EqView","Ne","NeView","OpConst","leftOp","BigInt","genLabel","diameter","operSymbol","params","ArithConst","ShiftConst","BaseCompareConst","CompareConst","EqCompareConst","AdditionConst","AdditionConstView","SubtractionConst","SubtractionConstView","MultiplicationConst","MultiplicationConstView","DivisionConst","DivisionConstView","ModuloConst","ModuloConstView","PowerConst","PowerConstView","ShiftLeftConst","ShiftLeftConstView","ShiftRightConst","ShiftRightConstView","LtConst","LtConstView","LeConst","LeConstView","GtConst","GtConstView","GeConst","GeConstView","EqConst","EqConstView","NeConst","NeConstView","BitExtend","input","output","ex","_extBit","BitExtendView","querySelector","ZeroExtend","ZeroExtendView","SignExtend","SignExtendView","BusSlice","first","count","total","s","BusSliceView","BusRegroup","num","gbits","entries","lbl","group_dir","contra","BusRegroupView","BusGroup","outdata","BusGroupView","BusUngroup","BusUngroupView","Subcircuit","IOs","getCells","cell","outputs","sortfun","localeCompare","sort","iomap","io","_warnings","getPortsPositions","positions","res","SubcircuitView","zoomInCircuit","paper","GenMux","sel","ins","muxInputs","path","drawBorder","muxInput","GenMuxView","_updateMux","Mux","n","toString","MuxView","Mux1Hot","info","transform","toArray","indexOf","Mux1HotView","MuxSparse","default_input","deflt","idx","MuxSparseView","Dff","initial","aload","clock","clr","srst","arst","enable","last_clk","pol","what","srbits","srbitmask","apply_sr","clk","ain","clrbitmask","en","DffView","Display3vlWithRegex","Memory","abits","rdports","wrports","words","portsplit","portsplits","portname","_memrdports","srst_polarity","arst_polarity","enable_polarity","clock_polarity","_memwrports","no_bit_enable","pop","removeProp","p","exec","portdata","init_value","memdata","Mem3vl","fromJSON","_memports","is_enabled","some","port_active","clkname","valid_addr","do_comb_read","addr","_calcaddr","write_value","oldval","mask","do_read","wrport","wrportname","mask_ok","transparent","collision","do_write","newval","eq","do_srst","srst_value","do_arst","arst_value","update_last_clk","toJSON","MemoryView","_displayEditor","div","title","append","ahex","ceil","columns","address","get_numbase","floor","c","clearMarkings","displayMarkings","updateStuff","row","addrs","col","repeat","redraw","ptrn","pattern","ds","table","closest","mem_change_cb","setTimeout","input_change_cb","off","FSM","init_state","states","trans_table","current_state","fsmgraph","statenodes","stateNo","isInit","resize","addTo","stateIn","trs","transitions","tr","trans","ctrlIn","ctrlOut","appendLabel","toBin","stateOut","state","pstate","removeAttr","pid","Map","state_in","state_out","ctrl_in","ctrl_out","next_trans","links","xmask","ixmask","results","other","eqs","next_output","FSMView","pdiv","resetCells","DirectedGraph","dagre","graphlib","elem","fitToContent","padding","allowNewOrigin","highColor","lowColor","Display7","LEDs","a","points","e","f","g","dp","cx","cy","groupSelector","Display7View","_updateDisplay","inputSignal","newAttrs","specialGates","Set","Link","constructor","gateParams","special","isSubcircuit","helper","_links_to","create","_params","_presentationParamChanged","_monitors","_ports","fromClonable","worker","_markPresentationParam","addLinkTo","add","removeLinkTo","delete","addLink","linkId","removeLink","targets","getPorts","values","event","postMessage","monitor","monitorId","unmonitor","getMonitors","_gates","_links","_observed","_subcircuit","addGate","gateId","link","removeGate","getGate","getLink","getGates","observe","unobserve","observed","setSubcircuit","subcircuit","_interval","_graphs","_monitorChecks","_alarms","_alarmQueue","_queue","_pq","FastPriorityQueue","_toUpdate","_toUpdateParam","_tick","_sender","setInterval","_sendUpdates","_updater","interval","ms","updateGates","reqid","sendUpdates","_updateGates","_postMonitors","_sendAck","peek","_updateGatesNext","k","updateGatesNext","poll","q","newOutputs","_enqueue","_setGateOutputSignals","ping","start","_stop","startFast","startTime","Date","now","_hasPendingEvents","stop","clearInterval","addGraph","graphId","sourceGate","targetGate","_setGateInputSignal","addSubcircuit","subgraphId","IOmap","subgraph","ioId","_setGateOutputSignal","observeGraph","_markUpdate","unobserveGraph","changeInput","changeParam","paramName","manualMemChange","triggerValues","stopOnTrigger","oneShot","synchronous","alarm","tick","alarmId","stopOnAlarm","unalarm","q1","assign","triggered","triggerValue","oldOutput","monitors","oldInput","subcirPort","updates","pendingEvents","response","self","onmessage","msg","arg","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","loaded","__webpack_modules__","m","__webpack_exports__","O","result","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","every","key","splice","definition","o","defineProperty","enumerable","chunkId","Promise","all","reduce","promises","u","globalThis","Function","obj","hasOwnProperty","Symbol","toStringTag","nmd","paths","scriptUrl","importScripts","location","currentScript","toUpperCase","scripts","getElementsByTagName","test","replace","installedChunks","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","then"],"ignoreList":[],"sourceRoot":""}